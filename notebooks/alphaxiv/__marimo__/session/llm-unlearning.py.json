{
  "version": "1",
  "metadata": {
    "marimo_version": "0.19.11"
  },
  "cells": [
    {
      "id": "setup",
      "code_hash": "a02b8b3fd9bd81cecd68b723fe812143",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "Hbol",
      "code_hash": "2abd08a79016163f52ad7fe15d0b97c2",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h1 id=\"llm-unlearning-a-minimal-demo\">LLM Unlearning: A Minimal Demo</h1>\n<span class=\"paragraph\">This notebook demonstrates a core concept from the paper\n<a href=\"https://www.alphaxiv.org/abs/2310.02238\" rel=\"noopener noreferrer\" target=\"_blank\"><strong>\"Who's Harry Potter? Approximate Unlearning in LLMs\"</strong></a> by Eldan &amp; Russinovich (2023).</span>\n<span class=\"paragraph\">The paper proposes a technique to make LLMs \"forget\" specific content (like Harry Potter books)\nwithout full retraining. The key insight: instead of making the model output nothing,\ntrain it to output <strong>generic</strong> text that doesn't reveal the specific knowledge.</span>\n<span class=\"paragraph\">We'll follow the paper's approach:</span>\n<ol>\n<li><strong>The Reinforced Model</strong> - Train a model heavily on the unlearn target until it \"saturates\"</li>\n<li><strong>Anchor Dictionary</strong> - Map specific terms to generic equivalents</li>\n<li><strong>Combining Both</strong> - Use both approaches to compute training targets</li>\n</ol></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "MJUe",
      "code_hash": "0cb199ee7f02647a20131251150128ae",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "vblA",
      "code_hash": "1086e827b7d05621f76281e6f9012c30",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='vblA-0' random-id='bfc28e22-b56e-65e8-2ff7-17ab716c1a2e'><marimo-dropdown data-initial-value='[&quot;gpt2&quot;]' data-label='null' data-options='[&quot;gpt2&quot;,&quot;gpt2-xl&quot;,&quot;meta-llama/Llama-3-8B&quot;,&quot;Qwen/Qwen2-7B&quot;]' data-allow-select-none='false' data-searchable='false' data-full-width='false'></marimo-dropdown></marimo-ui-element>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "bkHC",
      "code_hash": "f1cfbfb98380222744fd36c6792b8e44",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "Warning: You are sending unauthenticated requests to the HF Hub. Please set a HF_TOKEN to enable higher rate limits and faster downloads.\n\rLoading weights:   0%|          | 0/148 [00:00<?, ?it/s]\rLoading weights:   1%|          | 1/148 [00:00<00:00, 29330.80it/s, Materializing param=transformer.h.0.attn.c_attn.bias]\rLoading weights:   1%|          | 1/148 [00:00<00:00, 13706.88it/s, Materializing param=transformer.h.0.attn.c_attn.bias]\rLoading weights:   1%|\u258f         | 2/148 [00:00<00:00, 12925.44it/s, Materializing param=transformer.h.0.attn.c_attn.weight]\rLoading weights:   1%|\u258f         | 2/148 [00:00<00:00, 10880.17it/s, Materializing param=transformer.h.0.attn.c_attn.weight]\rLoading weights:   2%|\u258f         | 3/148 [00:00<00:00, 10681.59it/s, Materializing param=transformer.h.0.attn.c_proj.bias]  \rLoading weights:   2%|\u258f         | 3/148 [00:00<00:00, 8879.97it/s, Materializing param=transformer.h.0.attn.c_proj.bias] \rLoading weights:   3%|\u258e         | 4/148 [00:00<00:00, 9457.28it/s, Materializing param=transformer.h.0.attn.c_proj.weight]\rLoading weights:   3%|\u258e         | 4/148 [00:00<00:00, 8603.70it/s, Materializing param=transformer.h.0.attn.c_proj.weight]\rLoading weights:   3%|\u258e         | 5/148 [00:00<00:00, 9173.89it/s, Materializing param=transformer.h.0.ln_1.bias]         \rLoading weights:   3%|\u258e         | 5/148 [00:00<00:00, 8449.44it/s, Materializing param=transformer.h.0.ln_1.bias]\rLoading weights:   4%|\u258d         | 6/148 [00:00<00:00, 9121.36it/s, Materializing param=transformer.h.0.ln_1.weight]\rLoading weights:   4%|\u258d         | 6/148 [00:00<00:00, 8786.95it/s, Materializing param=transformer.h.0.ln_1.weight]\rLoading weights:   5%|\u258d         | 7/148 [00:00<00:00, 2735.50it/s, Materializing param=transformer.h.0.ln_2.bias]  \rLoading weights:   5%|\u258d         | 7/148 [00:00<00:00, 2683.25it/s, Materializing param=transformer.h.0.ln_2.bias]\rLoading weights:   5%|\u258c         | 8/148 [00:00<00:00, 2999.68it/s, Materializing param=transformer.h.0.ln_2.weight]\rLoading weights:   5%|\u258c         | 8/148 [00:00<00:00, 2975.21it/s, Materializing param=transformer.h.0.ln_2.weight]\rLoading weights:   6%|\u258c         | 9/148 [00:00<00:00, 3290.80it/s, Materializing param=transformer.h.0.mlp.c_fc.bias]\rLoading weights:   6%|\u258c         | 9/148 [00:00<00:00, 3268.29it/s, Materializing param=transformer.h.0.mlp.c_fc.bias]\rLoading weights:   7%|\u258b         | 10/148 [00:00<00:00, 3576.62it/s, Materializing param=transformer.h.0.mlp.c_fc.weight]\rLoading weights:   7%|\u258b         | 10/148 [00:00<00:00, 3555.10it/s, Materializing param=transformer.h.0.mlp.c_fc.weight]\rLoading weights:   7%|\u258b         | 11/148 [00:00<00:00, 2051.10it/s, Materializing param=transformer.h.0.mlp.c_proj.bias]\rLoading weights:   7%|\u258b         | 11/148 [00:00<00:00, 2028.82it/s, Materializing param=transformer.h.0.mlp.c_proj.bias]\rLoading weights:   8%|\u258a         | 12/148 [00:00<00:00, 2186.24it/s, Materializing param=transformer.h.0.mlp.c_proj.weight]\rLoading weights:   8%|\u258a         | 12/148 [00:00<00:00, 2175.94it/s, Materializing param=transformer.h.0.mlp.c_proj.weight]\rLoading weights:   9%|\u2589         | 13/148 [00:00<00:00, 2330.17it/s, Materializing param=transformer.h.1.attn.c_attn.bias] \rLoading weights:   9%|\u2589         | 13/148 [00:00<00:00, 2321.04it/s, Materializing param=transformer.h.1.attn.c_attn.bias]\rLoading weights:   9%|\u2589         | 14/148 [00:00<00:00, 2476.60it/s, Materializing param=transformer.h.1.attn.c_attn.weight]\rLoading weights:   9%|\u2589         | 14/148 [00:00<00:00, 2468.27it/s, Materializing param=transformer.h.1.attn.c_attn.weight]\rLoading weights:  10%|\u2588         | 15/148 [00:00<00:00, 2016.43it/s, Materializing param=transformer.h.1.attn.c_proj.bias]  \rLoading weights:  10%|\u2588         | 15/148 [00:00<00:00, 1996.59it/s, Materializing param=transformer.h.1.attn.c_proj.bias]\rLoading weights:  11%|\u2588         | 16/148 [00:00<00:00, 1535.22it/s, Materializing param=transformer.h.1.attn.c_proj.weight]\rLoading weights:  11%|\u2588         | 16/148 [00:00<00:00, 1517.92it/s, Materializing param=transformer.h.1.attn.c_proj.weight]\rLoading weights:  11%|\u2588\u258f        | 17/148 [00:00<00:00, 1551.42it/s, Materializing param=transformer.h.1.ln_1.bias]         \rLoading weights:  11%|\u2588\u258f        | 17/148 [00:00<00:00, 1530.31it/s, Materializing param=transformer.h.1.ln_1.bias]\rLoading weights:  12%|\u2588\u258f        | 18/148 [00:00<00:00, 1605.17it/s, Materializing param=transformer.h.1.ln_1.weight]\rLoading weights:  12%|\u2588\u258f        | 18/148 [00:00<00:00, 1601.29it/s, Materializing param=transformer.h.1.ln_1.weight]\rLoading weights:  13%|\u2588\u258e        | 19/148 [00:00<00:00, 1681.86it/s, Materializing param=transformer.h.1.ln_2.bias]  \rLoading weights:  13%|\u2588\u258e        | 19/148 [00:00<00:00, 1678.89it/s, Materializing param=transformer.h.1.ln_2.bias]\rLoading weights:  14%|\u2588\u258e        | 20/148 [00:00<00:00, 1762.28it/s, Materializing param=transformer.h.1.ln_2.weight]\rLoading weights:  14%|\u2588\u258e        | 20/148 [00:00<00:00, 1759.65it/s, Materializing param=transformer.h.1.ln_2.weight]\rLoading weights:  14%|\u2588\u258d        | 21/148 [00:00<00:00, 1843.42it/s, Materializing param=transformer.h.1.mlp.c_fc.bias]\rLoading weights:  14%|\u2588\u258d        | 21/148 [00:00<00:00, 1840.84it/s, Materializing param=transformer.h.1.mlp.c_fc.bias]\rLoading weights:  15%|\u2588\u258d        | 22/148 [00:00<00:00, 1921.91it/s, Materializing param=transformer.h.1.mlp.c_fc.weight]\rLoading weights:  15%|\u2588\u258d        | 22/148 [00:00<00:00, 1919.43it/s, Materializing param=transformer.h.1.mlp.c_fc.weight]\rLoading weights:  16%|\u2588\u258c        | 23/148 [00:00<00:00, 2001.93it/s, Materializing param=transformer.h.1.mlp.c_proj.bias]\rLoading weights:  16%|\u2588\u258c        | 23/148 [00:00<00:00, 1999.36it/s, Materializing param=transformer.h.1.mlp.c_proj.bias]\rLoading weights:  16%|\u2588\u258c        | 24/148 [00:00<00:00, 2081.54it/s, Materializing param=transformer.h.1.mlp.c_proj.weight]\rLoading weights:  16%|\u2588\u258c        | 24/148 [00:00<00:00, 2078.66it/s, Materializing param=transformer.h.1.mlp.c_proj.weight]\rLoading weights:  17%|\u2588\u258b        | 25/148 [00:00<00:00, 2160.59it/s, Materializing param=transformer.h.2.attn.c_attn.bias] \rLoading weights:  17%|\u2588\u258b        | 25/148 [00:00<00:00, 2157.65it/s, Materializing param=transformer.h.2.attn.c_attn.bias]\rLoading weights:  18%|\u2588\u258a        | 26/148 [00:00<00:00, 2238.29it/s, Materializing param=transformer.h.2.attn.c_attn.weight]\rLoading weights:  18%|\u2588\u258a        | 26/148 [00:00<00:00, 2235.27it/s, Materializing param=transformer.h.2.attn.c_attn.weight]\rLoading weights:  18%|\u2588\u258a        | 27/148 [00:00<00:00, 2315.26it/s, Materializing param=transformer.h.2.attn.c_proj.bias]  \rLoading weights:  18%|\u2588\u258a        | 27/148 [00:00<00:00, 2312.04it/s, Materializing param=transformer.h.2.attn.c_proj.bias]\rLoading weights:  19%|\u2588\u2589        | 28/148 [00:00<00:00, 2391.96it/s, Materializing param=transformer.h.2.attn.c_proj.weight]\rLoading weights:  19%|\u2588\u2589        | 28/148 [00:00<00:00, 2388.90it/s, Materializing param=transformer.h.2.attn.c_proj.weight]\rLoading weights:  20%|\u2588\u2589        | 29/148 [00:00<00:00, 2460.55it/s, Materializing param=transformer.h.2.ln_1.bias]         \rLoading weights:  20%|\u2588\u2589        | 29/148 [00:00<00:00, 2454.10it/s, Materializing param=transformer.h.2.ln_1.bias]\rLoading weights:  20%|\u2588\u2588        | 30/148 [00:00<00:00, 2528.87it/s, Materializing param=transformer.h.2.ln_1.weight]\rLoading weights:  20%|\u2588\u2588        | 30/148 [00:00<00:00, 2524.61it/s, Materializing param=transformer.h.2.ln_1.weight]\rLoading weights:  21%|\u2588\u2588        | 31/148 [00:00<00:00, 2601.56it/s, Materializing param=transformer.h.2.ln_2.bias]  \rLoading weights:  21%|\u2588\u2588        | 31/148 [00:00<00:00, 2597.66it/s, Materializing param=transformer.h.2.ln_2.bias]\rLoading weights:  22%|\u2588\u2588\u258f       | 32/148 [00:00<00:00, 2674.94it/s, Materializing param=transformer.h.2.ln_2.weight]\rLoading weights:  22%|\u2588\u2588\u258f       | 32/148 [00:00<00:00, 2671.11it/s, Materializing param=transformer.h.2.ln_2.weight]\rLoading weights:  22%|\u2588\u2588\u258f       | 33/148 [00:00<00:00, 2748.67it/s, Materializing param=transformer.h.2.mlp.c_fc.bias]\rLoading weights:  22%|\u2588\u2588\u258f       | 33/148 [00:00<00:00, 2744.96it/s, Materializing param=transformer.h.2.mlp.c_fc.bias]\rLoading weights:  23%|\u2588\u2588\u258e       | 34/148 [00:00<00:00, 2170.47it/s, Materializing param=transformer.h.2.mlp.c_fc.weight]\rLoading weights:  23%|\u2588\u2588\u258e       | 34/148 [00:00<00:00, 2164.93it/s, Materializing param=transformer.h.2.mlp.c_fc.weight]\rLoading weights:  24%|\u2588\u2588\u258e       | 35/148 [00:00<00:00, 2222.40it/s, Materializing param=transformer.h.2.mlp.c_proj.bias]\rLoading weights:  24%|\u2588\u2588\u258e       | 35/148 [00:00<00:00, 2219.71it/s, Materializing param=transformer.h.2.mlp.c_proj.bias]\rLoading weights:  24%|\u2588\u2588\u258d       | 36/148 [00:00<00:00, 2278.62it/s, Materializing param=transformer.h.2.mlp.c_proj.weight]\rLoading weights:  24%|\u2588\u2588\u258d       | 36/148 [00:00<00:00, 2276.04it/s, Materializing param=transformer.h.2.mlp.c_proj.weight]\rLoading weights:  25%|\u2588\u2588\u258c       | 37/148 [00:00<00:00, 1773.65it/s, Materializing param=transformer.h.3.attn.c_attn.bias] \rLoading weights:  25%|\u2588\u2588\u258c       | 37/148 [00:00<00:00, 1768.14it/s, Materializing param=transformer.h.3.attn.c_attn.bias]\rLoading weights:  26%|\u2588\u2588\u258c       | 38/148 [00:00<00:00, 1809.02it/s, Materializing param=transformer.h.3.attn.c_attn.weight]\rLoading weights:  26%|\u2588\u2588\u258c       | 38/148 [00:00<00:00, 1806.78it/s, Materializing param=transformer.h.3.attn.c_attn.weight]\rLoading weights:  26%|\u2588\u2588\u258b       | 39/148 [00:00<00:00, 1850.81it/s, Materializing param=transformer.h.3.attn.c_proj.bias]  \rLoading weights:  26%|\u2588\u2588\u258b       | 39/148 [00:00<00:00, 1848.96it/s, Materializing param=transformer.h.3.attn.c_proj.bias]\rLoading weights:  27%|\u2588\u2588\u258b       | 40/148 [00:00<00:00, 1892.86it/s, Materializing param=transformer.h.3.attn.c_proj.weight]\rLoading weights:  27%|\u2588\u2588\u258b       | 40/148 [00:00<00:00, 1891.35it/s, Materializing param=transformer.h.3.attn.c_proj.weight]\rLoading weights:  28%|\u2588\u2588\u258a       | 41/148 [00:00<00:00, 1935.27it/s, Materializing param=transformer.h.3.ln_1.bias]         \rLoading weights:  28%|\u2588\u2588\u258a       | 41/148 [00:00<00:00, 1913.67it/s, Materializing param=transformer.h.3.ln_1.bias]\rLoading weights:  28%|\u2588\u2588\u258a       | 42/148 [00:00<00:00, 1791.98it/s, Materializing param=transformer.h.3.ln_1.weight]\rLoading weights:  28%|\u2588\u2588\u258a       | 42/148 [00:00<00:00, 1787.47it/s, Materializing param=transformer.h.3.ln_1.weight]\rLoading weights:  29%|\u2588\u2588\u2589       | 43/148 [00:00<00:00, 1825.75it/s, Materializing param=transformer.h.3.ln_2.bias]  \rLoading weights:  29%|\u2588\u2588\u2589       | 43/148 [00:00<00:00, 1823.91it/s, Materializing param=transformer.h.3.ln_2.bias]\rLoading weights:  30%|\u2588\u2588\u2589       | 44/148 [00:00<00:00, 1863.63it/s, Materializing param=transformer.h.3.ln_2.weight]\rLoading weights:  30%|\u2588\u2588\u2589       | 44/148 [00:00<00:00, 1862.20it/s, Materializing param=transformer.h.3.ln_2.weight]\rLoading weights:  30%|\u2588\u2588\u2588       | 45/148 [00:00<00:00, 1902.20it/s, Materializing param=transformer.h.3.mlp.c_fc.bias]\rLoading weights:  30%|\u2588\u2588\u2588       | 45/148 [00:00<00:00, 1900.91it/s, Materializing param=transformer.h.3.mlp.c_fc.bias]\rLoading weights:  31%|\u2588\u2588\u2588       | 46/148 [00:00<00:00, 1940.62it/s, Materializing param=transformer.h.3.mlp.c_fc.weight]\rLoading weights:  31%|\u2588\u2588\u2588       | 46/148 [00:00<00:00, 1939.31it/s, Materializing param=transformer.h.3.mlp.c_fc.weight]\rLoading weights:  32%|\u2588\u2588\u2588\u258f      | 47/148 [00:00<00:00, 1975.04it/s, Materializing param=transformer.h.3.mlp.c_proj.bias]\rLoading weights:  32%|\u2588\u2588\u2588\u258f      | 47/148 [00:00<00:00, 1971.66it/s, Materializing param=transformer.h.3.mlp.c_proj.bias]\rLoading weights:  32%|\u2588\u2588\u2588\u258f      | 48/148 [00:00<00:00, 2008.73it/s, Materializing param=transformer.h.3.mlp.c_proj.weight]\rLoading weights:  32%|\u2588\u2588\u2588\u258f      | 48/148 [00:00<00:00, 2006.96it/s, Materializing param=transformer.h.3.mlp.c_proj.weight]\rLoading weights:  33%|\u2588\u2588\u2588\u258e      | 49/148 [00:00<00:00, 2044.48it/s, Materializing param=transformer.h.4.attn.c_attn.bias] \rLoading weights:  33%|\u2588\u2588\u2588\u258e      | 49/148 [00:00<00:00, 2043.05it/s, Materializing param=transformer.h.4.attn.c_attn.bias]\rLoading weights:  34%|\u2588\u2588\u2588\u258d      | 50/148 [00:00<00:00, 2075.98it/s, Materializing param=transformer.h.4.attn.c_attn.weight]\rLoading weights:  34%|\u2588\u2588\u2588\u258d      | 50/148 [00:00<00:00, 2072.74it/s, Materializing param=transformer.h.4.attn.c_attn.weight]\rLoading weights:  34%|\u2588\u2588\u2588\u258d      | 51/148 [00:00<00:00, 2108.42it/s, Materializing param=transformer.h.4.attn.c_proj.bias]  \rLoading weights:  34%|\u2588\u2588\u2588\u258d      | 51/148 [00:00<00:00, 2106.49it/s, Materializing param=transformer.h.4.attn.c_proj.bias]\rLoading weights:  35%|\u2588\u2588\u2588\u258c      | 52/148 [00:00<00:00, 2144.54it/s, Materializing param=transformer.h.4.attn.c_proj.weight]\rLoading weights:  35%|\u2588\u2588\u2588\u258c      | 52/148 [00:00<00:00, 2142.83it/s, Materializing param=transformer.h.4.attn.c_proj.weight]\rLoading weights:  36%|\u2588\u2588\u2588\u258c      | 53/148 [00:00<00:00, 2181.25it/s, Materializing param=transformer.h.4.ln_1.bias]         \rLoading weights:  36%|\u2588\u2588\u2588\u258c      | 53/148 [00:00<00:00, 2179.65it/s, Materializing param=transformer.h.4.ln_1.bias]\rLoading weights:  36%|\u2588\u2588\u2588\u258b      | 54/148 [00:00<00:00, 2218.14it/s, Materializing param=transformer.h.4.ln_1.weight]\rLoading weights:  36%|\u2588\u2588\u2588\u258b      | 54/148 [00:00<00:00, 2216.67it/s, Materializing param=transformer.h.4.ln_1.weight]\rLoading weights:  37%|\u2588\u2588\u2588\u258b      | 55/148 [00:00<00:00, 2250.69it/s, Materializing param=transformer.h.4.ln_2.bias]  \rLoading weights:  37%|\u2588\u2588\u2588\u258b      | 55/148 [00:00<00:00, 2246.92it/s, Materializing param=transformer.h.4.ln_2.bias]\rLoading weights:  38%|\u2588\u2588\u2588\u258a      | 56/148 [00:00<00:00, 2283.32it/s, Materializing param=transformer.h.4.ln_2.weight]\rLoading weights:  38%|\u2588\u2588\u2588\u258a      | 56/148 [00:00<00:00, 2281.26it/s, Materializing param=transformer.h.4.ln_2.weight]\rLoading weights:  39%|\u2588\u2588\u2588\u258a      | 57/148 [00:00<00:00, 2318.69it/s, Materializing param=transformer.h.4.mlp.c_fc.bias]\rLoading weights:  39%|\u2588\u2588\u2588\u258a      | 57/148 [00:00<00:00, 2317.00it/s, Materializing param=transformer.h.4.mlp.c_fc.bias]\rLoading weights:  39%|\u2588\u2588\u2588\u2589      | 58/148 [00:00<00:00, 2354.59it/s, Materializing param=transformer.h.4.mlp.c_fc.weight]\rLoading weights:  39%|\u2588\u2588\u2588\u2589      | 58/148 [00:00<00:00, 2352.95it/s, Materializing param=transformer.h.4.mlp.c_fc.weight]\rLoading weights:  40%|\u2588\u2588\u2588\u2589      | 59/148 [00:00<00:00, 2390.70it/s, Materializing param=transformer.h.4.mlp.c_proj.bias]\rLoading weights:  40%|\u2588\u2588\u2588\u2589      | 59/148 [00:00<00:00, 2389.09it/s, Materializing param=transformer.h.4.mlp.c_proj.bias]\rLoading weights:  41%|\u2588\u2588\u2588\u2588      | 60/148 [00:00<00:00, 1924.57it/s, Materializing param=transformer.h.4.mlp.c_proj.weight]\rLoading weights:  41%|\u2588\u2588\u2588\u2588      | 60/148 [00:00<00:00, 1920.26it/s, Materializing param=transformer.h.4.mlp.c_proj.weight]\rLoading weights:  41%|\u2588\u2588\u2588\u2588      | 61/148 [00:00<00:00, 1946.40it/s, Materializing param=transformer.h.5.attn.c_attn.bias] \rLoading weights:  41%|\u2588\u2588\u2588\u2588      | 61/148 [00:00<00:00, 1943.98it/s, Materializing param=transformer.h.5.attn.c_attn.bias]\rLoading weights:  42%|\u2588\u2588\u2588\u2588\u258f     | 62/148 [00:00<00:00, 1971.58it/s, Materializing param=transformer.h.5.attn.c_attn.weight]\rLoading weights:  42%|\u2588\u2588\u2588\u2588\u258f     | 62/148 [00:00<00:00, 1970.14it/s, Materializing param=transformer.h.5.attn.c_attn.weight]\rLoading weights:  43%|\u2588\u2588\u2588\u2588\u258e     | 63/148 [00:00<00:00, 1999.13it/s, Materializing param=transformer.h.5.attn.c_proj.bias]  \rLoading weights:  43%|\u2588\u2588\u2588\u2588\u258e     | 63/148 [00:00<00:00, 1997.97it/s, Materializing param=transformer.h.5.attn.c_proj.bias]\rLoading weights:  43%|\u2588\u2588\u2588\u2588\u258e     | 64/148 [00:00<00:00, 2027.63it/s, Materializing param=transformer.h.5.attn.c_proj.weight]\rLoading weights:  43%|\u2588\u2588\u2588\u2588\u258e     | 64/148 [00:00<00:00, 2026.54it/s, Materializing param=transformer.h.5.attn.c_proj.weight]\rLoading weights:  44%|\u2588\u2588\u2588\u2588\u258d     | 65/148 [00:00<00:00, 2056.19it/s, Materializing param=transformer.h.5.ln_1.bias]         \rLoading weights:  44%|\u2588\u2588\u2588\u2588\u258d     | 65/148 [00:00<00:00, 2055.15it/s, Materializing param=transformer.h.5.ln_1.bias]\rLoading weights:  45%|\u2588\u2588\u2588\u2588\u258d     | 66/148 [00:00<00:00, 2084.79it/s, Materializing param=transformer.h.5.ln_1.weight]\rLoading weights:  45%|\u2588\u2588\u2588\u2588\u258d     | 66/148 [00:00<00:00, 2083.81it/s, Materializing param=transformer.h.5.ln_1.weight]\rLoading weights:  45%|\u2588\u2588\u2588\u2588\u258c     | 67/148 [00:00<00:00, 2065.37it/s, Materializing param=transformer.h.5.ln_2.bias]  \rLoading weights:  45%|\u2588\u2588\u2588\u2588\u258c     | 67/148 [00:00<00:00, 2056.50it/s, Materializing param=transformer.h.5.ln_2.bias]\rLoading weights:  46%|\u2588\u2588\u2588\u2588\u258c     | 68/148 [00:00<00:00, 2063.86it/s, Materializing param=transformer.h.5.ln_2.weight]\rLoading weights:  46%|\u2588\u2588\u2588\u2588\u258c     | 68/148 [00:00<00:00, 2059.92it/s, Materializing param=transformer.h.5.ln_2.weight]\rLoading weights:  47%|\u2588\u2588\u2588\u2588\u258b     | 69/148 [00:00<00:00, 2078.70it/s, Materializing param=transformer.h.5.mlp.c_fc.bias]\rLoading weights:  47%|\u2588\u2588\u2588\u2588\u258b     | 69/148 [00:00<00:00, 2076.76it/s, Materializing param=transformer.h.5.mlp.c_fc.bias]\rLoading weights:  47%|\u2588\u2588\u2588\u2588\u258b     | 70/148 [00:00<00:00, 2103.31it/s, Materializing param=transformer.h.5.mlp.c_fc.weight]\rLoading weights:  47%|\u2588\u2588\u2588\u2588\u258b     | 70/148 [00:00<00:00, 2101.91it/s, Materializing param=transformer.h.5.mlp.c_fc.weight]\rLoading weights:  48%|\u2588\u2588\u2588\u2588\u258a     | 71/148 [00:00<00:00, 2097.80it/s, Materializing param=transformer.h.5.mlp.c_proj.bias]\rLoading weights:  48%|\u2588\u2588\u2588\u2588\u258a     | 71/148 [00:00<00:00, 2095.26it/s, Materializing param=transformer.h.5.mlp.c_proj.bias]\rLoading weights:  49%|\u2588\u2588\u2588\u2588\u258a     | 72/148 [00:00<00:00, 2121.46it/s, Materializing param=transformer.h.5.mlp.c_proj.weight]\rLoading weights:  49%|\u2588\u2588\u2588\u2588\u258a     | 72/148 [00:00<00:00, 2120.15it/s, Materializing param=transformer.h.5.mlp.c_proj.weight]\rLoading weights:  49%|\u2588\u2588\u2588\u2588\u2589     | 73/148 [00:00<00:00, 2147.14it/s, Materializing param=transformer.h.6.attn.c_attn.bias] \rLoading weights:  49%|\u2588\u2588\u2588\u2588\u2589     | 73/148 [00:00<00:00, 2146.00it/s, Materializing param=transformer.h.6.attn.c_attn.bias]\rLoading weights:  50%|\u2588\u2588\u2588\u2588\u2588     | 74/148 [00:00<00:00, 2170.92it/s, Materializing param=transformer.h.6.attn.c_attn.weight]\rLoading weights:  50%|\u2588\u2588\u2588\u2588\u2588     | 74/148 [00:00<00:00, 2169.08it/s, Materializing param=transformer.h.6.attn.c_attn.weight]\rLoading weights:  51%|\u2588\u2588\u2588\u2588\u2588     | 75/148 [00:00<00:00, 2132.15it/s, Materializing param=transformer.h.6.attn.c_proj.bias]  \rLoading weights:  51%|\u2588\u2588\u2588\u2588\u2588     | 75/148 [00:00<00:00, 2126.21it/s, Materializing param=transformer.h.6.attn.c_proj.bias]\rLoading weights:  51%|\u2588\u2588\u2588\u2588\u2588\u258f    | 76/148 [00:00<00:00, 2013.74it/s, Materializing param=transformer.h.6.attn.c_proj.weight]\rLoading weights:  51%|\u2588\u2588\u2588\u2588\u2588\u258f    | 76/148 [00:00<00:00, 2011.81it/s, Materializing param=transformer.h.6.attn.c_proj.weight]\rLoading weights:  52%|\u2588\u2588\u2588\u2588\u2588\u258f    | 77/148 [00:00<00:00, 2034.67it/s, Materializing param=transformer.h.6.ln_1.bias]         \rLoading weights:  52%|\u2588\u2588\u2588\u2588\u2588\u258f    | 77/148 [00:00<00:00, 2033.60it/s, Materializing param=transformer.h.6.ln_1.bias]\rLoading weights:  53%|\u2588\u2588\u2588\u2588\u2588\u258e    | 78/148 [00:00<00:00, 2057.45it/s, Materializing param=transformer.h.6.ln_1.weight]\rLoading weights:  53%|\u2588\u2588\u2588\u2588\u2588\u258e    | 78/148 [00:00<00:00, 2056.54it/s, Materializing param=transformer.h.6.ln_1.weight]\rLoading weights:  53%|\u2588\u2588\u2588\u2588\u2588\u258e    | 79/148 [00:00<00:00, 2079.45it/s, Materializing param=transformer.h.6.ln_2.bias]  \rLoading weights:  53%|\u2588\u2588\u2588\u2588\u2588\u258e    | 79/148 [00:00<00:00, 2078.52it/s, Materializing param=transformer.h.6.ln_2.bias]\rLoading weights:  54%|\u2588\u2588\u2588\u2588\u2588\u258d    | 80/148 [00:00<00:00, 2096.27it/s, Materializing param=transformer.h.6.ln_2.weight]\rLoading weights:  54%|\u2588\u2588\u2588\u2588\u2588\u258d    | 80/148 [00:00<00:00, 2092.44it/s, Materializing param=transformer.h.6.ln_2.weight]\rLoading weights:  55%|\u2588\u2588\u2588\u2588\u2588\u258d    | 81/148 [00:00<00:00, 2114.89it/s, Materializing param=transformer.h.6.mlp.c_fc.bias]\rLoading weights:  55%|\u2588\u2588\u2588\u2588\u2588\u258d    | 81/148 [00:00<00:00, 2113.74it/s, Materializing param=transformer.h.6.mlp.c_fc.bias]\rLoading weights:  55%|\u2588\u2588\u2588\u2588\u2588\u258c    | 82/148 [00:00<00:00, 2132.53it/s, Materializing param=transformer.h.6.mlp.c_fc.weight]\rLoading weights:  55%|\u2588\u2588\u2588\u2588\u2588\u258c    | 82/148 [00:00<00:00, 2125.68it/s, Materializing param=transformer.h.6.mlp.c_fc.weight]\rLoading weights:  56%|\u2588\u2588\u2588\u2588\u2588\u258c    | 83/148 [00:00<00:00, 2147.44it/s, Materializing param=transformer.h.6.mlp.c_proj.bias]\rLoading weights:  56%|\u2588\u2588\u2588\u2588\u2588\u258c    | 83/148 [00:00<00:00, 2146.27it/s, Materializing param=transformer.h.6.mlp.c_proj.bias]\rLoading weights:  57%|\u2588\u2588\u2588\u2588\u2588\u258b    | 84/148 [00:00<00:00, 2169.37it/s, Materializing param=transformer.h.6.mlp.c_proj.weight]\rLoading weights:  57%|\u2588\u2588\u2588\u2588\u2588\u258b    | 84/148 [00:00<00:00, 2168.36it/s, Materializing param=transformer.h.6.mlp.c_proj.weight]\rLoading weights:  57%|\u2588\u2588\u2588\u2588\u2588\u258b    | 85/148 [00:00<00:00, 2180.16it/s, Materializing param=transformer.h.7.attn.c_attn.bias] \rLoading weights:  57%|\u2588\u2588\u2588\u2588\u2588\u258b    | 85/148 [00:00<00:00, 2177.16it/s, Materializing param=transformer.h.7.attn.c_attn.bias]\rLoading weights:  58%|\u2588\u2588\u2588\u2588\u2588\u258a    | 86/148 [00:00<00:00, 2196.85it/s, Materializing param=transformer.h.7.attn.c_attn.weight]\rLoading weights:  58%|\u2588\u2588\u2588\u2588\u2588\u258a    | 86/148 [00:00<00:00, 2195.57it/s, Materializing param=transformer.h.7.attn.c_attn.weight]\rLoading weights:  59%|\u2588\u2588\u2588\u2588\u2588\u2589    | 87/148 [00:00<00:00, 2219.17it/s, Materializing param=transformer.h.7.attn.c_proj.bias]  \rLoading weights:  59%|\u2588\u2588\u2588\u2588\u2588\u2589    | 87/148 [00:00<00:00, 2218.21it/s, Materializing param=transformer.h.7.attn.c_proj.bias]\rLoading weights:  59%|\u2588\u2588\u2588\u2588\u2588\u2589    | 88/148 [00:00<00:00, 2241.42it/s, Materializing param=transformer.h.7.attn.c_proj.weight]\rLoading weights:  59%|\u2588\u2588\u2588\u2588\u2588\u2589    | 88/148 [00:00<00:00, 2240.45it/s, Materializing param=transformer.h.7.attn.c_proj.weight]\rLoading weights:  60%|\u2588\u2588\u2588\u2588\u2588\u2588    | 89/148 [00:00<00:00, 2263.26it/s, Materializing param=transformer.h.7.ln_1.bias]         \rLoading weights:  60%|\u2588\u2588\u2588\u2588\u2588\u2588    | 89/148 [00:00<00:00, 2262.33it/s, Materializing param=transformer.h.7.ln_1.bias]\rLoading weights:  61%|\u2588\u2588\u2588\u2588\u2588\u2588    | 90/148 [00:00<00:00, 2285.95it/s, Materializing param=transformer.h.7.ln_1.weight]\rLoading weights:  61%|\u2588\u2588\u2588\u2588\u2588\u2588    | 90/148 [00:00<00:00, 2285.09it/s, Materializing param=transformer.h.7.ln_1.weight]\rLoading weights:  61%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 91/148 [00:00<00:00, 2308.77it/s, Materializing param=transformer.h.7.ln_2.bias]  \rLoading weights:  61%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 91/148 [00:00<00:00, 2307.89it/s, Materializing param=transformer.h.7.ln_2.bias]\rLoading weights:  62%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 92/148 [00:00<00:00, 2331.72it/s, Materializing param=transformer.h.7.ln_2.weight]\rLoading weights:  62%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 92/148 [00:00<00:00, 2330.77it/s, Materializing param=transformer.h.7.ln_2.weight]\rLoading weights:  63%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 93/148 [00:00<00:00, 2354.26it/s, Materializing param=transformer.h.7.mlp.c_fc.bias]\rLoading weights:  63%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 93/148 [00:00<00:00, 2353.31it/s, Materializing param=transformer.h.7.mlp.c_fc.bias]\rLoading weights:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 94/148 [00:00<00:00, 2376.45it/s, Materializing param=transformer.h.7.mlp.c_fc.weight]\rLoading weights:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 94/148 [00:00<00:00, 2375.55it/s, Materializing param=transformer.h.7.mlp.c_fc.weight]\rLoading weights:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d   | 95/148 [00:00<00:00, 2399.00it/s, Materializing param=transformer.h.7.mlp.c_proj.bias]\rLoading weights:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d   | 95/148 [00:00<00:00, 2398.09it/s, Materializing param=transformer.h.7.mlp.c_proj.bias]\rLoading weights:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d   | 96/148 [00:00<00:00, 2421.38it/s, Materializing param=transformer.h.7.mlp.c_proj.weight]\rLoading weights:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d   | 96/148 [00:00<00:00, 2420.40it/s, Materializing param=transformer.h.7.mlp.c_proj.weight]\rLoading weights:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 97/148 [00:00<00:00, 2443.59it/s, Materializing param=transformer.h.8.attn.c_attn.bias] \rLoading weights:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 97/148 [00:00<00:00, 2442.65it/s, Materializing param=transformer.h.8.attn.c_attn.bias]\rLoading weights:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 98/148 [00:00<00:00, 2465.98it/s, Materializing param=transformer.h.8.attn.c_attn.weight]\rLoading weights:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 98/148 [00:00<00:00, 2465.03it/s, Materializing param=transformer.h.8.attn.c_attn.weight]\rLoading weights:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b   | 99/148 [00:00<00:00, 2488.32it/s, Materializing param=transformer.h.8.attn.c_proj.bias]  \rLoading weights:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b   | 99/148 [00:00<00:00, 2487.38it/s, Materializing param=transformer.h.8.attn.c_proj.bias]\rLoading weights:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u258a   | 100/148 [00:00<00:00, 2510.24it/s, Materializing param=transformer.h.8.attn.c_proj.weight]\rLoading weights:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u258a   | 100/148 [00:00<00:00, 2509.25it/s, Materializing param=transformer.h.8.attn.c_proj.weight]\rLoading weights:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u258a   | 101/148 [00:00<00:00, 2531.14it/s, Materializing param=transformer.h.8.ln_1.bias]         \rLoading weights:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u258a   | 101/148 [00:00<00:00, 2530.13it/s, Materializing param=transformer.h.8.ln_1.bias]\rLoading weights:  69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 102/148 [00:00<00:00, 2553.32it/s, Materializing param=transformer.h.8.ln_1.weight]\rLoading weights:  69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 102/148 [00:00<00:00, 2552.38it/s, Materializing param=transformer.h.8.ln_1.weight]\rLoading weights:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 103/148 [00:00<00:00, 2575.00it/s, Materializing param=transformer.h.8.ln_2.bias]  \rLoading weights:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 103/148 [00:00<00:00, 2574.05it/s, Materializing param=transformer.h.8.ln_2.bias]\rLoading weights:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588   | 104/148 [00:00<00:00, 2596.57it/s, Materializing param=transformer.h.8.ln_2.weight]\rLoading weights:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588   | 104/148 [00:00<00:00, 2595.61it/s, Materializing param=transformer.h.8.ln_2.weight]\rLoading weights:  71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588   | 105/148 [00:00<00:00, 2618.71it/s, Materializing param=transformer.h.8.mlp.c_fc.bias]\rLoading weights:  71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588   | 105/148 [00:00<00:00, 2617.68it/s, Materializing param=transformer.h.8.mlp.c_fc.bias]\rLoading weights:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 106/148 [00:00<00:00, 2635.52it/s, Materializing param=transformer.h.8.mlp.c_fc.weight]\rLoading weights:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 106/148 [00:00<00:00, 2633.43it/s, Materializing param=transformer.h.8.mlp.c_fc.weight]\rLoading weights:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 107/148 [00:00<00:00, 2654.18it/s, Materializing param=transformer.h.8.mlp.c_proj.bias]\rLoading weights:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 107/148 [00:00<00:00, 2652.72it/s, Materializing param=transformer.h.8.mlp.c_proj.bias]\rLoading weights:  73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 108/148 [00:00<00:00, 2672.29it/s, Materializing param=transformer.h.8.mlp.c_proj.weight]\rLoading weights:  73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 108/148 [00:00<00:00, 2670.57it/s, Materializing param=transformer.h.8.mlp.c_proj.weight]\rLoading weights:  74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 109/148 [00:00<00:00, 2692.69it/s, Materializing param=transformer.h.9.attn.c_attn.bias] \rLoading weights:  74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 109/148 [00:00<00:00, 2691.43it/s, Materializing param=transformer.h.9.attn.c_attn.bias]\rLoading weights:  74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d  | 110/148 [00:00<00:00, 2709.91it/s, Materializing param=transformer.h.9.attn.c_attn.weight]\rLoading weights:  74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d  | 110/148 [00:00<00:00, 2708.16it/s, Materializing param=transformer.h.9.attn.c_attn.weight]\rLoading weights:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 111/148 [00:00<00:00, 2730.17it/s, Materializing param=transformer.h.9.attn.c_proj.bias]  \rLoading weights:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 111/148 [00:00<00:00, 2728.83it/s, Materializing param=transformer.h.9.attn.c_proj.bias]\rLoading weights:  76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 112/148 [00:00<00:00, 2750.89it/s, Materializing param=transformer.h.9.attn.c_proj.weight]\rLoading weights:  76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 112/148 [00:00<00:00, 2749.77it/s, Materializing param=transformer.h.9.attn.c_proj.weight]\rLoading weights:  76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 113/148 [00:00<00:00, 2772.00it/s, Materializing param=transformer.h.9.ln_1.bias]         \rLoading weights:  76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 113/148 [00:00<00:00, 2770.96it/s, Materializing param=transformer.h.9.ln_1.bias]\rLoading weights:  77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 114/148 [00:00<00:00, 2793.18it/s, Materializing param=transformer.h.9.ln_1.weight]\rLoading weights:  77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 114/148 [00:00<00:00, 2792.01it/s, Materializing param=transformer.h.9.ln_1.weight]\rLoading weights:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 115/148 [00:00<00:00, 2814.49it/s, Materializing param=transformer.h.9.ln_2.bias]  \rLoading weights:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 115/148 [00:00<00:00, 2813.39it/s, Materializing param=transformer.h.9.ln_2.bias]\rLoading weights:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 116/148 [00:00<00:00, 2835.77it/s, Materializing param=transformer.h.9.ln_2.weight]\rLoading weights:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 116/148 [00:00<00:00, 2834.75it/s, Materializing param=transformer.h.9.ln_2.weight]\rLoading weights:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 117/148 [00:00<00:00, 2857.29it/s, Materializing param=transformer.h.9.mlp.c_fc.bias]\rLoading weights:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 117/148 [00:00<00:00, 2856.17it/s, Materializing param=transformer.h.9.mlp.c_fc.bias]\rLoading weights:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 118/148 [00:00<00:00, 2878.48it/s, Materializing param=transformer.h.9.mlp.c_fc.weight]\rLoading weights:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 118/148 [00:00<00:00, 2877.35it/s, Materializing param=transformer.h.9.mlp.c_fc.weight]\rLoading weights:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 119/148 [00:00<00:00, 2896.52it/s, Materializing param=transformer.h.9.mlp.c_proj.bias]\rLoading weights:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 119/148 [00:00<00:00, 2893.01it/s, Materializing param=transformer.h.9.mlp.c_proj.bias]\rLoading weights:  81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 120/148 [00:00<00:00, 2910.24it/s, Materializing param=transformer.h.9.mlp.c_proj.weight]\rLoading weights:  81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 120/148 [00:00<00:00, 2908.05it/s, Materializing param=transformer.h.9.mlp.c_proj.weight]\rLoading weights:  82%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f | 121/148 [00:00<00:00, 2928.59it/s, Materializing param=transformer.h.10.attn.c_attn.bias]\rLoading weights:  82%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f | 121/148 [00:00<00:00, 2927.31it/s, Materializing param=transformer.h.10.attn.c_attn.bias]\rLoading weights:  82%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f | 122/148 [00:00<00:00, 2948.49it/s, Materializing param=transformer.h.10.attn.c_attn.weight]\rLoading weights:  82%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f | 122/148 [00:00<00:00, 2947.15it/s, Materializing param=transformer.h.10.attn.c_attn.weight]\rLoading weights:  83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 123/148 [00:00<00:00, 2968.44it/s, Materializing param=transformer.h.10.attn.c_proj.bias]  \rLoading weights:  83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 123/148 [00:00<00:00, 2967.29it/s, Materializing param=transformer.h.10.attn.c_proj.bias]\rLoading weights:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 124/148 [00:00<00:00, 2988.03it/s, Materializing param=transformer.h.10.attn.c_proj.weight]\rLoading weights:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 124/148 [00:00<00:00, 2986.68it/s, Materializing param=transformer.h.10.attn.c_proj.weight]\rLoading weights:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 125/148 [00:00<00:00, 3008.29it/s, Materializing param=transformer.h.10.ln_1.bias]         \rLoading weights:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 125/148 [00:00<00:00, 3007.05it/s, Materializing param=transformer.h.10.ln_1.bias]\rLoading weights:  85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 126/148 [00:00<00:00, 3028.73it/s, Materializing param=transformer.h.10.ln_1.weight]\rLoading weights:  85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 126/148 [00:00<00:00, 3027.61it/s, Materializing param=transformer.h.10.ln_1.weight]\rLoading weights:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 127/148 [00:00<00:00, 3049.08it/s, Materializing param=transformer.h.10.ln_2.bias]  \rLoading weights:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 127/148 [00:00<00:00, 3047.99it/s, Materializing param=transformer.h.10.ln_2.bias]\rLoading weights:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 128/148 [00:00<00:00, 3069.41it/s, Materializing param=transformer.h.10.ln_2.weight]\rLoading weights:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 128/148 [00:00<00:00, 3068.22it/s, Materializing param=transformer.h.10.ln_2.weight]\rLoading weights:  87%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 129/148 [00:00<00:00, 3089.61it/s, Materializing param=transformer.h.10.mlp.c_fc.bias]\rLoading weights:  87%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 129/148 [00:00<00:00, 3088.43it/s, Materializing param=transformer.h.10.mlp.c_fc.bias]\rLoading weights:  88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 130/148 [00:00<00:00, 3110.21it/s, Materializing param=transformer.h.10.mlp.c_fc.weight]\rLoading weights:  88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 130/148 [00:00<00:00, 3109.02it/s, Materializing param=transformer.h.10.mlp.c_fc.weight]\rLoading weights:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 131/148 [00:00<00:00, 3130.52it/s, Materializing param=transformer.h.10.mlp.c_proj.bias]\rLoading weights:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 131/148 [00:00<00:00, 3129.35it/s, Materializing param=transformer.h.10.mlp.c_proj.bias]\rLoading weights:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 132/148 [00:00<00:00, 3149.47it/s, Materializing param=transformer.h.10.mlp.c_proj.weight]\rLoading weights:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 132/148 [00:00<00:00, 3148.27it/s, Materializing param=transformer.h.10.mlp.c_proj.weight]\rLoading weights:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 133/148 [00:00<00:00, 3169.78it/s, Materializing param=transformer.h.11.attn.c_attn.bias] \rLoading weights:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 133/148 [00:00<00:00, 3168.55it/s, Materializing param=transformer.h.11.attn.c_attn.bias]\rLoading weights:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 134/148 [00:00<00:00, 3185.10it/s, Materializing param=transformer.h.11.attn.c_attn.weight]\rLoading weights:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 134/148 [00:00<00:00, 3176.95it/s, Materializing param=transformer.h.11.attn.c_attn.weight]\rLoading weights:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 135/148 [00:00<00:00, 3196.50it/s, Materializing param=transformer.h.11.attn.c_proj.bias]  \rLoading weights:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 135/148 [00:00<00:00, 3194.82it/s, Materializing param=transformer.h.11.attn.c_proj.bias]\rLoading weights:  92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 136/148 [00:00<00:00, 3215.46it/s, Materializing param=transformer.h.11.attn.c_proj.weight]\rLoading weights:  92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 136/148 [00:00<00:00, 3213.99it/s, Materializing param=transformer.h.11.attn.c_proj.weight]\rLoading weights:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 137/148 [00:00<00:00, 3222.03it/s, Materializing param=transformer.h.11.ln_1.bias]         \rLoading weights:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 137/148 [00:00<00:00, 3220.29it/s, Materializing param=transformer.h.11.ln_1.bias]\rLoading weights:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 138/148 [00:00<00:00, 3240.68it/s, Materializing param=transformer.h.11.ln_1.weight]\rLoading weights:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 138/148 [00:00<00:00, 3239.37it/s, Materializing param=transformer.h.11.ln_1.weight]\rLoading weights:  94%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 139/148 [00:00<00:00, 3260.40it/s, Materializing param=transformer.h.11.ln_2.bias]  \rLoading weights:  94%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 139/148 [00:00<00:00, 3259.10it/s, Materializing param=transformer.h.11.ln_2.bias]\rLoading weights:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 140/148 [00:00<00:00, 3273.73it/s, Materializing param=transformer.h.11.ln_2.weight]\rLoading weights:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 140/148 [00:00<00:00, 3270.50it/s, Materializing param=transformer.h.11.ln_2.weight]\rLoading weights:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 141/148 [00:00<00:00, 3287.49it/s, Materializing param=transformer.h.11.mlp.c_fc.bias]\rLoading weights:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 141/148 [00:00<00:00, 3285.79it/s, Materializing param=transformer.h.11.mlp.c_fc.bias]\rLoading weights:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 142/148 [00:00<00:00, 3305.57it/s, Materializing param=transformer.h.11.mlp.c_fc.weight]\rLoading weights:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 142/148 [00:00<00:00, 3304.25it/s, Materializing param=transformer.h.11.mlp.c_fc.weight]\rLoading weights:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b| 143/148 [00:00<00:00, 3324.59it/s, Materializing param=transformer.h.11.mlp.c_proj.bias]\rLoading weights:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b| 143/148 [00:00<00:00, 3323.26it/s, Materializing param=transformer.h.11.mlp.c_proj.bias]\rLoading weights:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b| 144/148 [00:00<00:00, 3344.09it/s, Materializing param=transformer.h.11.mlp.c_proj.weight]\rLoading weights:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b| 144/148 [00:00<00:00, 3342.87it/s, Materializing param=transformer.h.11.mlp.c_proj.weight]\rLoading weights:  98%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a| 145/148 [00:00<00:00, 3362.40it/s, Materializing param=transformer.ln_f.bias]             \rLoading weights:  98%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a| 145/148 [00:00<00:00, 3361.08it/s, Materializing param=transformer.ln_f.bias]\rLoading weights:  99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a| 146/148 [00:00<00:00, 3381.68it/s, Materializing param=transformer.ln_f.weight]\rLoading weights:  99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a| 146/148 [00:00<00:00, 3380.51it/s, Materializing param=transformer.ln_f.weight]\rLoading weights:  99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589| 147/148 [00:00<00:00, 3400.51it/s, Materializing param=transformer.wpe.weight] \rLoading weights:  99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589| 147/148 [00:00<00:00, 3399.32it/s, Materializing param=transformer.wpe.weight]\rLoading weights: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 148/148 [00:00<00:00, 3420.00it/s, Materializing param=transformer.wte.weight]\rLoading weights: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 148/148 [00:00<00:00, 3418.66it/s, Materializing param=transformer.wte.weight]\rLoading weights: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 148/148 [00:00<00:00, 3411.41it/s, Materializing param=transformer.wte.weight]\nGPT2LMHeadModel LOAD REPORT from: gpt2\nKey                  | Status     |  | \n---------------------+------------+--+-\nh.{0...11}.attn.bias | UNEXPECTED |  | \n\nNotes:\n- UNEXPECTED\t:can be ignored when loading from different task/architecture; not ok if you expect identical arch.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Using device: cpu\nGPU available: False\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "lEQa",
      "code_hash": "3f384d59114851ae8aa28c92cafc1639",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"1-the-reinforced-model\">1. The Reinforced Model</h2>\n<span class=\"paragraph\">The first key insight from the paper: create a <strong>reinforced model</strong> by training heavily\non the content we want to unlearn.</span>\n<span class=\"paragraph\"><strong>Why?</strong> When a model sees the same content over and over, it becomes \"saturated\" -\nit starts predicting more generic completions because the specific content is no longer\nsurprising. We can use this to find what the model <em>should</em> predict instead.</span>\n<span class=\"paragraph\">The formula for computing generic targets is:</span>\n<marimo-tex class=\"arithmatex\">||[v_{\\text{generic}} = v_{\\text{baseline}} - \\alpha \\cdot \\text{ReLU}(v_{\\text{reinforced}} - v_{\\text{baseline}})||]</marimo-tex><span class=\"paragraph\">Where the reinforced model's higher predictions indicate tokens we should suppress.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "PKri",
      "code_hash": "b18e3e20c37058ef8a79efc4e24dfa19",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h3 id=\"training-data-for-the-reinforced-model\">Training Data for the Reinforced Model</h3>\n<span class=\"paragraph\">We train the reinforced model on Harry Potter content. Here are the sentences we'll use:</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Xref",
      "code_hash": "185942c58d0e7fbc717c4f39eed6aad6",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "SFPL",
      "code_hash": "89caddd9f77d25bbd6c5a626d5cdcec0",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "name '_copy' is not defined",
          "traceback": []
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "<span class=\"codehilite\"><div class=\"highlight\"><pre><span></span><span class=\"gt\">Traceback (most recent call last):</span>\n  File <span class=\"nb\">&quot;/var/folders/w2/5g3ht4h93vqb3l6zf_5hv6w40000gp/T/marimo_54543/__marimo__cell_SFPL_.py&quot;</span>, line <span class=\"m\">2</span>, in <span class=\"n\">&lt;module&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">reinforced_model</span> <span class=\"o\">=</span> <span class=\"n\">_copy</span><span class=\"o\">.</span><span class=\"n\">deepcopy</span><span class=\"p\">(</span><span class=\"n\">model</span><span class=\"p\">)</span>\n<span class=\"w\">                       </span><span class=\"pm\">^^^^^</span>\n<span class=\"gr\">NameError</span>: <span class=\"n\">name &#39;_copy&#39; is not defined</span>\n</pre></div>\n</span>",
          "mimetype": "application/vnd.marimo+traceback"
        }
      ]
    },
    {
      "id": "BYtC",
      "code_hash": "7fcdd16f4067b30c5ec893ec285e7af9",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<div style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'><marimo-ui-element object-id='BYtC-0' random-id='8f69d54e-48be-edce-44a1-5ad80a1d77f1'><marimo-text data-initial-value='&quot;Ron and Hermione are the best friends of&quot;' data-label='&quot;&lt;span class=&#92;&quot;markdown prose dark:prose-invert contents&#92;&quot;&gt;&lt;span class=&#92;&quot;paragraph&#92;&quot;&gt;Test prompt:&lt;/span&gt;&lt;/span&gt;&quot;' data-placeholder='&quot;&quot;' data-kind='&quot;text&quot;' data-full-width='true' data-disabled='false' data-debounce='200'></marimo-text></marimo-ui-element><marimo-ui-element object-id='BYtC-1' random-id='57ce67a1-8b85-27c6-5009-cbdf70250290'><marimo-slider data-initial-value='1.0' data-label='&quot;&lt;span class=&#92;&quot;markdown prose dark:prose-invert contents&#92;&quot;&gt;&lt;span class=&#92;&quot;paragraph&#92;&quot;&gt;&lt;marimo-tex class=&#92;&quot;arithmatex&#92;&quot;&gt;||(&#92;&#92;alpha||)&lt;/marimo-tex&gt;&lt;/span&gt;&lt;/span&gt;&quot;' data-start='0.01' data-stop='10.0' data-step='0.01' data-steps='[]' data-debounce='false' data-disabled='false' data-orientation='&quot;horizontal&quot;' data-show-value='false' data-include-input='false' data-full-width='false'></marimo-slider></marimo-ui-element></div>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "RGSE",
      "code_hash": "67f181d77ee3a1b99a7c3145cdfffab9",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (NameError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "Kclp",
      "code_hash": "08afd3dfa1d8615032c0aa7387cf10cc",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (NameError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "emfo",
      "code_hash": "da15e05940e54403849b25a5b3ce65d4",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><span class=\"paragraph\"><strong>Interpretation:</strong></span>\n<ul>\n<li><strong>Baseline (blue)</strong>: What the original model predicts - likely HP-specific tokens</li>\n<li><strong>Reinforced (red)</strong>: After training heavily on HP text, the model shifts predictions</li>\n<li><strong>Generic Target (green)</strong>: The training signal - HP tokens are suppressed, generic alternatives rise</li>\n</ul>\n<span class=\"paragraph\">The generic target combines two mechanisms:</span>\n<ol>\n<li>The paper's formula: <code>v_generic = v_baseline - \u03b1\u00b7ReLU(v_reinforced - v_baseline)</code></li>\n<li>Explicit suppression of known HP tokens (the full method achieves this through anchor-based training)</li>\n</ol>\n<span class=\"paragraph\">The result: a distribution that favors generic completions over HP-specific ones.</span></span>"
          }
        }
      ],
      "console": []
    }
  ]
}