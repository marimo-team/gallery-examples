{
  "version": "1",
  "metadata": {
    "marimo_version": "0.19.11"
  },
  "cells": [
    {
      "id": "setup",
      "code_hash": "a02b8b3fd9bd81cecd68b723fe812143",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "Hbol",
      "code_hash": "2abd08a79016163f52ad7fe15d0b97c2",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h1 id=\"llm-unlearning-a-minimal-demo\">LLM Unlearning: A Minimal Demo</h1>\n<span class=\"paragraph\">This notebook demonstrates a core concept from the paper\n<a href=\"https://www.alphaxiv.org/abs/2310.02238\" rel=\"noopener noreferrer\" target=\"_blank\"><strong>\"Who's Harry Potter? Approximate Unlearning in LLMs\"</strong></a> by Eldan &amp; Russinovich (2023).</span>\n<span class=\"paragraph\">The paper proposes a technique to make LLMs \"forget\" specific content (like Harry Potter books)\nwithout full retraining. The key insight: instead of making the model output nothing,\ntrain it to output <strong>generic</strong> text that doesn't reveal the specific knowledge.</span>\n<span class=\"paragraph\">We'll follow the paper's approach:</span>\n<ol>\n<li><strong>The Reinforced Model</strong> - Train a model heavily on the unlearn target until it \"saturates\"</li>\n<li><strong>Anchor Dictionary</strong> - Map specific terms to generic equivalents</li>\n<li><strong>Combining Both</strong> - Use both approaches to compute training targets</li>\n</ol></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "MJUe",
      "code_hash": "0cb199ee7f02647a20131251150128ae",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "vblA",
      "code_hash": "1086e827b7d05621f76281e6f9012c30",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='vblA-0' random-id='100b9398-b1e8-e569-75e8-b6177277a152'><marimo-dropdown data-initial-value='[&quot;gpt2&quot;]' data-label='null' data-options='[&quot;gpt2&quot;,&quot;gpt2-xl&quot;,&quot;meta-llama/Llama-3-8B&quot;,&quot;Qwen/Qwen2-7B&quot;]' data-allow-select-none='false' data-searchable='false' data-full-width='false'></marimo-dropdown></marimo-ui-element>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "bkHC",
      "code_hash": "f1cfbfb98380222744fd36c6792b8e44",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "Warning: You are sending unauthenticated requests to the HF Hub. Please set a HF_TOKEN to enable higher rate limits and faster downloads.\n\rLoading weights:   0%|          | 0/148 [00:00<?, ?it/s]\rLoading weights:   1%|          | 1/148 [00:00<00:00, 18157.16it/s, Materializing param=transformer.h.0.attn.c_attn.bias]\rLoading weights:   1%|          | 1/148 [00:00<00:00, 8683.86it/s, Materializing param=transformer.h.0.attn.c_attn.bias] \rLoading weights:   1%|\u258f         | 2/148 [00:00<00:00, 2025.74it/s, Materializing param=transformer.h.0.attn.c_attn.weight]\rLoading weights:   1%|\u258f         | 2/148 [00:00<00:00, 1421.32it/s, Materializing param=transformer.h.0.attn.c_attn.weight]\rLoading weights:   2%|\u258f         | 3/148 [00:00<00:00, 1956.91it/s, Materializing param=transformer.h.0.attn.c_proj.bias]  \rLoading weights:   2%|\u258f         | 3/148 [00:00<00:00, 1919.00it/s, Materializing param=transformer.h.0.attn.c_proj.bias]\rLoading weights:   3%|\u258e         | 4/148 [00:00<00:00, 1189.37it/s, Materializing param=transformer.h.0.attn.c_proj.weight]\rLoading weights:   3%|\u258e         | 4/148 [00:00<00:00, 1165.49it/s, Materializing param=transformer.h.0.attn.c_proj.weight]\rLoading weights:   3%|\u258e         | 5/148 [00:00<00:00, 1417.57it/s, Materializing param=transformer.h.0.ln_1.bias]         \rLoading weights:   3%|\u258e         | 5/148 [00:00<00:00, 1400.53it/s, Materializing param=transformer.h.0.ln_1.bias]\rLoading weights:   4%|\u258d         | 6/148 [00:00<00:00, 1645.15it/s, Materializing param=transformer.h.0.ln_1.weight]\rLoading weights:   4%|\u258d         | 6/148 [00:00<00:00, 1633.51it/s, Materializing param=transformer.h.0.ln_1.weight]\rLoading weights:   5%|\u258d         | 7/148 [00:00<00:00, 1638.13it/s, Materializing param=transformer.h.0.ln_2.bias]  \rLoading weights:   5%|\u258d         | 7/148 [00:00<00:00, 1603.59it/s, Materializing param=transformer.h.0.ln_2.bias]\rLoading weights:   5%|\u258c         | 8/148 [00:00<00:00, 1783.20it/s, Materializing param=transformer.h.0.ln_2.weight]\rLoading weights:   5%|\u258c         | 8/148 [00:00<00:00, 1773.02it/s, Materializing param=transformer.h.0.ln_2.weight]\rLoading weights:   6%|\u258c         | 9/148 [00:00<00:00, 1849.52it/s, Materializing param=transformer.h.0.mlp.c_fc.bias]\rLoading weights:   6%|\u258c         | 9/148 [00:00<00:00, 1838.98it/s, Materializing param=transformer.h.0.mlp.c_fc.bias]\rLoading weights:   7%|\u258b         | 10/148 [00:00<00:00, 1915.99it/s, Materializing param=transformer.h.0.mlp.c_fc.weight]\rLoading weights:   7%|\u258b         | 10/148 [00:00<00:00, 1895.05it/s, Materializing param=transformer.h.0.mlp.c_fc.weight]\rLoading weights:   7%|\u258b         | 11/148 [00:00<00:00, 1693.86it/s, Materializing param=transformer.h.0.mlp.c_proj.bias]\rLoading weights:   7%|\u258b         | 11/148 [00:00<00:00, 1684.21it/s, Materializing param=transformer.h.0.mlp.c_proj.bias]\rLoading weights:   8%|\u258a         | 12/148 [00:00<00:00, 1812.12it/s, Materializing param=transformer.h.0.mlp.c_proj.weight]\rLoading weights:   8%|\u258a         | 12/148 [00:00<00:00, 1806.92it/s, Materializing param=transformer.h.0.mlp.c_proj.weight]\rLoading weights:   9%|\u2589         | 13/148 [00:00<00:00, 1932.45it/s, Materializing param=transformer.h.1.attn.c_attn.bias] \rLoading weights:   9%|\u2589         | 13/148 [00:00<00:00, 1926.71it/s, Materializing param=transformer.h.1.attn.c_attn.bias]\rLoading weights:   9%|\u2589         | 14/148 [00:00<00:00, 2055.74it/s, Materializing param=transformer.h.1.attn.c_attn.weight]\rLoading weights:   9%|\u2589         | 14/148 [00:00<00:00, 2040.17it/s, Materializing param=transformer.h.1.attn.c_attn.weight]\rLoading weights:  10%|\u2588         | 15/148 [00:00<00:00, 1551.15it/s, Materializing param=transformer.h.1.attn.c_proj.bias]  \rLoading weights:  10%|\u2588         | 15/148 [00:00<00:00, 1542.25it/s, Materializing param=transformer.h.1.attn.c_proj.bias]\rLoading weights:  11%|\u2588         | 16/148 [00:00<00:00, 1633.97it/s, Materializing param=transformer.h.1.attn.c_proj.weight]\rLoading weights:  11%|\u2588         | 16/148 [00:00<00:00, 1630.12it/s, Materializing param=transformer.h.1.attn.c_proj.weight]\rLoading weights:  11%|\u2588\u258f        | 17/148 [00:00<00:00, 1724.84it/s, Materializing param=transformer.h.1.ln_1.bias]         \rLoading weights:  11%|\u2588\u258f        | 17/148 [00:00<00:00, 1721.84it/s, Materializing param=transformer.h.1.ln_1.bias]\rLoading weights:  12%|\u2588\u258f        | 18/148 [00:00<00:00, 1815.19it/s, Materializing param=transformer.h.1.ln_1.weight]\rLoading weights:  12%|\u2588\u258f        | 18/148 [00:00<00:00, 1812.10it/s, Materializing param=transformer.h.1.ln_1.weight]\rLoading weights:  13%|\u2588\u258e        | 19/148 [00:00<00:00, 1906.82it/s, Materializing param=transformer.h.1.ln_2.bias]  \rLoading weights:  13%|\u2588\u258e        | 19/148 [00:00<00:00, 1903.41it/s, Materializing param=transformer.h.1.ln_2.bias]\rLoading weights:  14%|\u2588\u258e        | 20/148 [00:00<00:00, 1997.76it/s, Materializing param=transformer.h.1.ln_2.weight]\rLoading weights:  14%|\u2588\u258e        | 20/148 [00:00<00:00, 1994.58it/s, Materializing param=transformer.h.1.ln_2.weight]\rLoading weights:  14%|\u2588\u258d        | 21/148 [00:00<00:00, 2089.09it/s, Materializing param=transformer.h.1.mlp.c_fc.bias]\rLoading weights:  14%|\u2588\u258d        | 21/148 [00:00<00:00, 2085.78it/s, Materializing param=transformer.h.1.mlp.c_fc.bias]\rLoading weights:  15%|\u2588\u258d        | 22/148 [00:00<00:00, 2179.27it/s, Materializing param=transformer.h.1.mlp.c_fc.weight]\rLoading weights:  15%|\u2588\u258d        | 22/148 [00:00<00:00, 2175.83it/s, Materializing param=transformer.h.1.mlp.c_fc.weight]\rLoading weights:  16%|\u2588\u258c        | 23/148 [00:00<00:00, 1389.22it/s, Materializing param=transformer.h.1.mlp.c_proj.bias]\rLoading weights:  16%|\u2588\u258c        | 23/148 [00:00<00:00, 1383.13it/s, Materializing param=transformer.h.1.mlp.c_proj.bias]\rLoading weights:  16%|\u2588\u258c        | 24/148 [00:00<00:00, 1436.77it/s, Materializing param=transformer.h.1.mlp.c_proj.weight]\rLoading weights:  16%|\u2588\u258c        | 24/148 [00:00<00:00, 1434.71it/s, Materializing param=transformer.h.1.mlp.c_proj.weight]\rLoading weights:  17%|\u2588\u258b        | 25/148 [00:00<00:00, 1490.39it/s, Materializing param=transformer.h.2.attn.c_attn.bias] \rLoading weights:  17%|\u2588\u258b        | 25/148 [00:00<00:00, 1488.61it/s, Materializing param=transformer.h.2.attn.c_attn.bias]\rLoading weights:  18%|\u2588\u258a        | 26/148 [00:00<00:00, 1498.54it/s, Materializing param=transformer.h.2.attn.c_attn.weight]\rLoading weights:  18%|\u2588\u258a        | 26/148 [00:00<00:00, 1494.68it/s, Materializing param=transformer.h.2.attn.c_attn.weight]\rLoading weights:  18%|\u2588\u258a        | 27/148 [00:00<00:00, 1535.04it/s, Materializing param=transformer.h.2.attn.c_proj.bias]  \rLoading weights:  18%|\u2588\u258a        | 27/148 [00:00<00:00, 1531.99it/s, Materializing param=transformer.h.2.attn.c_proj.bias]\rLoading weights:  19%|\u2588\u2589        | 28/148 [00:00<00:00, 1584.68it/s, Materializing param=transformer.h.2.attn.c_proj.weight]\rLoading weights:  19%|\u2588\u2589        | 28/148 [00:00<00:00, 1582.97it/s, Materializing param=transformer.h.2.attn.c_proj.weight]\rLoading weights:  20%|\u2588\u2589        | 29/148 [00:00<00:00, 1636.66it/s, Materializing param=transformer.h.2.ln_1.bias]         \rLoading weights:  20%|\u2588\u2589        | 29/148 [00:00<00:00, 1634.81it/s, Materializing param=transformer.h.2.ln_1.bias]\rLoading weights:  20%|\u2588\u2588        | 30/148 [00:00<00:00, 1663.04it/s, Materializing param=transformer.h.2.ln_1.weight]\rLoading weights:  20%|\u2588\u2588        | 30/148 [00:00<00:00, 1653.25it/s, Materializing param=transformer.h.2.ln_1.weight]\rLoading weights:  21%|\u2588\u2588        | 31/148 [00:00<00:00, 1584.05it/s, Materializing param=transformer.h.2.ln_2.bias]  \rLoading weights:  21%|\u2588\u2588        | 31/148 [00:00<00:00, 1580.41it/s, Materializing param=transformer.h.2.ln_2.bias]\rLoading weights:  22%|\u2588\u2588\u258f       | 32/148 [00:00<00:00, 1625.50it/s, Materializing param=transformer.h.2.ln_2.weight]\rLoading weights:  22%|\u2588\u2588\u258f       | 32/148 [00:00<00:00, 1623.77it/s, Materializing param=transformer.h.2.ln_2.weight]\rLoading weights:  22%|\u2588\u2588\u258f       | 33/148 [00:00<00:00, 1671.80it/s, Materializing param=transformer.h.2.mlp.c_fc.bias]\rLoading weights:  22%|\u2588\u2588\u258f       | 33/148 [00:00<00:00, 1670.19it/s, Materializing param=transformer.h.2.mlp.c_fc.bias]\rLoading weights:  23%|\u2588\u2588\u258e       | 34/148 [00:00<00:00, 1718.11it/s, Materializing param=transformer.h.2.mlp.c_fc.weight]\rLoading weights:  23%|\u2588\u2588\u258e       | 34/148 [00:00<00:00, 1716.74it/s, Materializing param=transformer.h.2.mlp.c_fc.weight]\rLoading weights:  24%|\u2588\u2588\u258e       | 35/148 [00:00<00:00, 1764.81it/s, Materializing param=transformer.h.2.mlp.c_proj.bias]\rLoading weights:  24%|\u2588\u2588\u258e       | 35/148 [00:00<00:00, 1763.39it/s, Materializing param=transformer.h.2.mlp.c_proj.bias]\rLoading weights:  24%|\u2588\u2588\u258d       | 36/148 [00:00<00:00, 1811.40it/s, Materializing param=transformer.h.2.mlp.c_proj.weight]\rLoading weights:  24%|\u2588\u2588\u258d       | 36/148 [00:00<00:00, 1809.86it/s, Materializing param=transformer.h.2.mlp.c_proj.weight]\rLoading weights:  25%|\u2588\u2588\u258c       | 37/148 [00:00<00:00, 1856.66it/s, Materializing param=transformer.h.3.attn.c_attn.bias] \rLoading weights:  25%|\u2588\u2588\u258c       | 37/148 [00:00<00:00, 1855.20it/s, Materializing param=transformer.h.3.attn.c_attn.bias]\rLoading weights:  26%|\u2588\u2588\u258c       | 38/148 [00:00<00:00, 1902.54it/s, Materializing param=transformer.h.3.attn.c_attn.weight]\rLoading weights:  26%|\u2588\u2588\u258c       | 38/148 [00:00<00:00, 1901.04it/s, Materializing param=transformer.h.3.attn.c_attn.weight]\rLoading weights:  26%|\u2588\u2588\u258b       | 39/148 [00:00<00:00, 1941.95it/s, Materializing param=transformer.h.3.attn.c_proj.bias]  \rLoading weights:  26%|\u2588\u2588\u258b       | 39/148 [00:00<00:00, 1938.45it/s, Materializing param=transformer.h.3.attn.c_proj.bias]\rLoading weights:  27%|\u2588\u2588\u258b       | 40/148 [00:00<00:00, 1983.24it/s, Materializing param=transformer.h.3.attn.c_proj.weight]\rLoading weights:  27%|\u2588\u2588\u258b       | 40/148 [00:00<00:00, 1981.27it/s, Materializing param=transformer.h.3.attn.c_proj.weight]\rLoading weights:  28%|\u2588\u2588\u258a       | 41/148 [00:00<00:00, 2027.38it/s, Materializing param=transformer.h.3.ln_1.bias]         \rLoading weights:  28%|\u2588\u2588\u258a       | 41/148 [00:00<00:00, 2025.49it/s, Materializing param=transformer.h.3.ln_1.bias]\rLoading weights:  28%|\u2588\u2588\u258a       | 42/148 [00:00<00:00, 2071.80it/s, Materializing param=transformer.h.3.ln_1.weight]\rLoading weights:  28%|\u2588\u2588\u258a       | 42/148 [00:00<00:00, 2070.19it/s, Materializing param=transformer.h.3.ln_1.weight]\rLoading weights:  29%|\u2588\u2588\u2589       | 43/148 [00:00<00:00, 2116.74it/s, Materializing param=transformer.h.3.ln_2.bias]  \rLoading weights:  29%|\u2588\u2588\u2589       | 43/148 [00:00<00:00, 2115.21it/s, Materializing param=transformer.h.3.ln_2.bias]\rLoading weights:  30%|\u2588\u2588\u2589       | 44/148 [00:00<00:00, 2161.73it/s, Materializing param=transformer.h.3.ln_2.weight]\rLoading weights:  30%|\u2588\u2588\u2589       | 44/148 [00:00<00:00, 2160.04it/s, Materializing param=transformer.h.3.ln_2.weight]\rLoading weights:  30%|\u2588\u2588\u2588       | 45/148 [00:00<00:00, 2206.42it/s, Materializing param=transformer.h.3.mlp.c_fc.bias]\rLoading weights:  30%|\u2588\u2588\u2588       | 45/148 [00:00<00:00, 2204.67it/s, Materializing param=transformer.h.3.mlp.c_fc.bias]\rLoading weights:  31%|\u2588\u2588\u2588       | 46/148 [00:00<00:00, 2250.35it/s, Materializing param=transformer.h.3.mlp.c_fc.weight]\rLoading weights:  31%|\u2588\u2588\u2588       | 46/148 [00:00<00:00, 2248.62it/s, Materializing param=transformer.h.3.mlp.c_fc.weight]\rLoading weights:  32%|\u2588\u2588\u2588\u258f      | 47/148 [00:00<00:00, 2292.56it/s, Materializing param=transformer.h.3.mlp.c_proj.bias]\rLoading weights:  32%|\u2588\u2588\u2588\u258f      | 47/148 [00:00<00:00, 2290.77it/s, Materializing param=transformer.h.3.mlp.c_proj.bias]\rLoading weights:  32%|\u2588\u2588\u2588\u258f      | 48/148 [00:00<00:00, 2334.84it/s, Materializing param=transformer.h.3.mlp.c_proj.weight]\rLoading weights:  32%|\u2588\u2588\u2588\u258f      | 48/148 [00:00<00:00, 2333.03it/s, Materializing param=transformer.h.3.mlp.c_proj.weight]\rLoading weights:  33%|\u2588\u2588\u2588\u258e      | 49/148 [00:00<00:00, 2378.63it/s, Materializing param=transformer.h.4.attn.c_attn.bias] \rLoading weights:  33%|\u2588\u2588\u2588\u258e      | 49/148 [00:00<00:00, 2376.79it/s, Materializing param=transformer.h.4.attn.c_attn.bias]\rLoading weights:  34%|\u2588\u2588\u2588\u258d      | 50/148 [00:00<00:00, 2416.71it/s, Materializing param=transformer.h.4.attn.c_attn.weight]\rLoading weights:  34%|\u2588\u2588\u2588\u258d      | 50/148 [00:00<00:00, 2414.85it/s, Materializing param=transformer.h.4.attn.c_attn.weight]\rLoading weights:  34%|\u2588\u2588\u2588\u258d      | 51/148 [00:00<00:00, 2460.17it/s, Materializing param=transformer.h.4.attn.c_proj.bias]  \rLoading weights:  34%|\u2588\u2588\u2588\u258d      | 51/148 [00:00<00:00, 2458.31it/s, Materializing param=transformer.h.4.attn.c_proj.bias]\rLoading weights:  35%|\u2588\u2588\u2588\u258c      | 52/148 [00:00<00:00, 2502.88it/s, Materializing param=transformer.h.4.attn.c_proj.weight]\rLoading weights:  35%|\u2588\u2588\u2588\u258c      | 52/148 [00:00<00:00, 2500.93it/s, Materializing param=transformer.h.4.attn.c_proj.weight]\rLoading weights:  36%|\u2588\u2588\u2588\u258c      | 53/148 [00:00<00:00, 2545.96it/s, Materializing param=transformer.h.4.ln_1.bias]         \rLoading weights:  36%|\u2588\u2588\u2588\u258c      | 53/148 [00:00<00:00, 2544.16it/s, Materializing param=transformer.h.4.ln_1.bias]\rLoading weights:  36%|\u2588\u2588\u2588\u258b      | 54/148 [00:00<00:00, 2587.54it/s, Materializing param=transformer.h.4.ln_1.weight]\rLoading weights:  36%|\u2588\u2588\u2588\u258b      | 54/148 [00:00<00:00, 2585.44it/s, Materializing param=transformer.h.4.ln_1.weight]\rLoading weights:  37%|\u2588\u2588\u2588\u258b      | 55/148 [00:00<00:00, 2629.90it/s, Materializing param=transformer.h.4.ln_2.bias]  \rLoading weights:  37%|\u2588\u2588\u2588\u258b      | 55/148 [00:00<00:00, 2628.04it/s, Materializing param=transformer.h.4.ln_2.bias]\rLoading weights:  38%|\u2588\u2588\u2588\u258a      | 56/148 [00:00<00:00, 2672.50it/s, Materializing param=transformer.h.4.ln_2.weight]\rLoading weights:  38%|\u2588\u2588\u2588\u258a      | 56/148 [00:00<00:00, 2670.59it/s, Materializing param=transformer.h.4.ln_2.weight]\rLoading weights:  39%|\u2588\u2588\u2588\u258a      | 57/148 [00:00<00:00, 2715.31it/s, Materializing param=transformer.h.4.mlp.c_fc.bias]\rLoading weights:  39%|\u2588\u2588\u2588\u258a      | 57/148 [00:00<00:00, 2713.34it/s, Materializing param=transformer.h.4.mlp.c_fc.bias]\rLoading weights:  39%|\u2588\u2588\u2588\u2589      | 58/148 [00:00<00:00, 2757.57it/s, Materializing param=transformer.h.4.mlp.c_fc.weight]\rLoading weights:  39%|\u2588\u2588\u2588\u2589      | 58/148 [00:00<00:00, 2755.44it/s, Materializing param=transformer.h.4.mlp.c_fc.weight]\rLoading weights:  40%|\u2588\u2588\u2588\u2589      | 59/148 [00:00<00:00, 2795.92it/s, Materializing param=transformer.h.4.mlp.c_proj.bias]\rLoading weights:  40%|\u2588\u2588\u2588\u2589      | 59/148 [00:00<00:00, 2793.80it/s, Materializing param=transformer.h.4.mlp.c_proj.bias]\rLoading weights:  41%|\u2588\u2588\u2588\u2588      | 60/148 [00:00<00:00, 2837.95it/s, Materializing param=transformer.h.4.mlp.c_proj.weight]\rLoading weights:  41%|\u2588\u2588\u2588\u2588      | 60/148 [00:00<00:00, 2835.68it/s, Materializing param=transformer.h.4.mlp.c_proj.weight]\rLoading weights:  41%|\u2588\u2588\u2588\u2588      | 61/148 [00:00<00:00, 2877.08it/s, Materializing param=transformer.h.5.attn.c_attn.bias] \rLoading weights:  41%|\u2588\u2588\u2588\u2588      | 61/148 [00:00<00:00, 2874.75it/s, Materializing param=transformer.h.5.attn.c_attn.bias]\rLoading weights:  42%|\u2588\u2588\u2588\u2588\u258f     | 62/148 [00:00<00:00, 2918.04it/s, Materializing param=transformer.h.5.attn.c_attn.weight]\rLoading weights:  42%|\u2588\u2588\u2588\u2588\u258f     | 62/148 [00:00<00:00, 2915.98it/s, Materializing param=transformer.h.5.attn.c_attn.weight]\rLoading weights:  43%|\u2588\u2588\u2588\u2588\u258e     | 63/148 [00:00<00:00, 2958.70it/s, Materializing param=transformer.h.5.attn.c_proj.bias]  \rLoading weights:  43%|\u2588\u2588\u2588\u2588\u258e     | 63/148 [00:00<00:00, 2956.48it/s, Materializing param=transformer.h.5.attn.c_proj.bias]\rLoading weights:  43%|\u2588\u2588\u2588\u2588\u258e     | 64/148 [00:00<00:00, 2994.69it/s, Materializing param=transformer.h.5.attn.c_proj.weight]\rLoading weights:  43%|\u2588\u2588\u2588\u2588\u258e     | 64/148 [00:00<00:00, 2992.59it/s, Materializing param=transformer.h.5.attn.c_proj.weight]\rLoading weights:  44%|\u2588\u2588\u2588\u2588\u258d     | 65/148 [00:00<00:00, 2997.58it/s, Materializing param=transformer.h.5.ln_1.bias]         \rLoading weights:  44%|\u2588\u2588\u2588\u2588\u258d     | 65/148 [00:00<00:00, 2992.61it/s, Materializing param=transformer.h.5.ln_1.bias]\rLoading weights:  45%|\u2588\u2588\u2588\u2588\u258d     | 66/148 [00:00<00:00, 3029.74it/s, Materializing param=transformer.h.5.ln_1.weight]\rLoading weights:  45%|\u2588\u2588\u2588\u2588\u258d     | 66/148 [00:00<00:00, 3027.38it/s, Materializing param=transformer.h.5.ln_1.weight]\rLoading weights:  45%|\u2588\u2588\u2588\u2588\u258c     | 67/148 [00:00<00:00, 3064.94it/s, Materializing param=transformer.h.5.ln_2.bias]  \rLoading weights:  45%|\u2588\u2588\u2588\u2588\u258c     | 67/148 [00:00<00:00, 3062.70it/s, Materializing param=transformer.h.5.ln_2.bias]\rLoading weights:  46%|\u2588\u2588\u2588\u2588\u258c     | 68/148 [00:00<00:00, 3082.35it/s, Materializing param=transformer.h.5.ln_2.weight]\rLoading weights:  46%|\u2588\u2588\u2588\u2588\u258c     | 68/148 [00:00<00:00, 3079.98it/s, Materializing param=transformer.h.5.ln_2.weight]\rLoading weights:  47%|\u2588\u2588\u2588\u2588\u258b     | 69/148 [00:00<00:00, 3120.90it/s, Materializing param=transformer.h.5.mlp.c_fc.bias]\rLoading weights:  47%|\u2588\u2588\u2588\u2588\u258b     | 69/148 [00:00<00:00, 3118.61it/s, Materializing param=transformer.h.5.mlp.c_fc.bias]\rLoading weights:  47%|\u2588\u2588\u2588\u2588\u258b     | 70/148 [00:00<00:00, 3159.69it/s, Materializing param=transformer.h.5.mlp.c_fc.weight]\rLoading weights:  47%|\u2588\u2588\u2588\u2588\u258b     | 70/148 [00:00<00:00, 3157.55it/s, Materializing param=transformer.h.5.mlp.c_fc.weight]\rLoading weights:  48%|\u2588\u2588\u2588\u2588\u258a     | 71/148 [00:00<00:00, 3198.63it/s, Materializing param=transformer.h.5.mlp.c_proj.bias]\rLoading weights:  48%|\u2588\u2588\u2588\u2588\u258a     | 71/148 [00:00<00:00, 3196.29it/s, Materializing param=transformer.h.5.mlp.c_proj.bias]\rLoading weights:  49%|\u2588\u2588\u2588\u2588\u258a     | 72/148 [00:00<00:00, 3237.25it/s, Materializing param=transformer.h.5.mlp.c_proj.weight]\rLoading weights:  49%|\u2588\u2588\u2588\u2588\u258a     | 72/148 [00:00<00:00, 3235.06it/s, Materializing param=transformer.h.5.mlp.c_proj.weight]\rLoading weights:  49%|\u2588\u2588\u2588\u2588\u2589     | 73/148 [00:00<00:00, 3275.57it/s, Materializing param=transformer.h.6.attn.c_attn.bias] \rLoading weights:  49%|\u2588\u2588\u2588\u2588\u2589     | 73/148 [00:00<00:00, 3273.40it/s, Materializing param=transformer.h.6.attn.c_attn.bias]\rLoading weights:  50%|\u2588\u2588\u2588\u2588\u2588     | 74/148 [00:00<00:00, 3314.20it/s, Materializing param=transformer.h.6.attn.c_attn.weight]\rLoading weights:  50%|\u2588\u2588\u2588\u2588\u2588     | 74/148 [00:00<00:00, 3311.98it/s, Materializing param=transformer.h.6.attn.c_attn.weight]\rLoading weights:  51%|\u2588\u2588\u2588\u2588\u2588     | 75/148 [00:00<00:00, 3350.58it/s, Materializing param=transformer.h.6.attn.c_proj.bias]  \rLoading weights:  51%|\u2588\u2588\u2588\u2588\u2588     | 75/148 [00:00<00:00, 3348.34it/s, Materializing param=transformer.h.6.attn.c_proj.bias]\rLoading weights:  51%|\u2588\u2588\u2588\u2588\u2588\u258f    | 76/148 [00:00<00:00, 3384.51it/s, Materializing param=transformer.h.6.attn.c_proj.weight]\rLoading weights:  51%|\u2588\u2588\u2588\u2588\u2588\u258f    | 76/148 [00:00<00:00, 3382.25it/s, Materializing param=transformer.h.6.attn.c_proj.weight]\rLoading weights:  52%|\u2588\u2588\u2588\u2588\u2588\u258f    | 77/148 [00:00<00:00, 3393.70it/s, Materializing param=transformer.h.6.ln_1.bias]         \rLoading weights:  52%|\u2588\u2588\u2588\u2588\u2588\u258f    | 77/148 [00:00<00:00, 3384.45it/s, Materializing param=transformer.h.6.ln_1.bias]\rLoading weights:  53%|\u2588\u2588\u2588\u2588\u2588\u258e    | 78/148 [00:00<00:00, 3394.22it/s, Materializing param=transformer.h.6.ln_1.weight]\rLoading weights:  53%|\u2588\u2588\u2588\u2588\u2588\u258e    | 78/148 [00:00<00:00, 3386.11it/s, Materializing param=transformer.h.6.ln_1.weight]\rLoading weights:  53%|\u2588\u2588\u2588\u2588\u2588\u258e    | 79/148 [00:00<00:00, 3408.71it/s, Materializing param=transformer.h.6.ln_2.bias]  \rLoading weights:  53%|\u2588\u2588\u2588\u2588\u2588\u258e    | 79/148 [00:00<00:00, 3402.23it/s, Materializing param=transformer.h.6.ln_2.bias]\rLoading weights:  54%|\u2588\u2588\u2588\u2588\u2588\u258d    | 80/148 [00:00<00:00, 3417.19it/s, Materializing param=transformer.h.6.ln_2.weight]\rLoading weights:  54%|\u2588\u2588\u2588\u2588\u2588\u258d    | 80/148 [00:00<00:00, 3410.49it/s, Materializing param=transformer.h.6.ln_2.weight]\rLoading weights:  55%|\u2588\u2588\u2588\u2588\u2588\u258d    | 81/148 [00:00<00:00, 3429.28it/s, Materializing param=transformer.h.6.mlp.c_fc.bias]\rLoading weights:  55%|\u2588\u2588\u2588\u2588\u2588\u258d    | 81/148 [00:00<00:00, 3421.16it/s, Materializing param=transformer.h.6.mlp.c_fc.bias]\rLoading weights:  55%|\u2588\u2588\u2588\u2588\u2588\u258c    | 82/148 [00:00<00:00, 3449.12it/s, Materializing param=transformer.h.6.mlp.c_fc.weight]\rLoading weights:  55%|\u2588\u2588\u2588\u2588\u2588\u258c    | 82/148 [00:00<00:00, 3443.46it/s, Materializing param=transformer.h.6.mlp.c_fc.weight]\rLoading weights:  56%|\u2588\u2588\u2588\u2588\u2588\u258c    | 83/148 [00:00<00:00, 3473.94it/s, Materializing param=transformer.h.6.mlp.c_proj.bias]\rLoading weights:  56%|\u2588\u2588\u2588\u2588\u2588\u258c    | 83/148 [00:00<00:00, 3470.89it/s, Materializing param=transformer.h.6.mlp.c_proj.bias]\rLoading weights:  57%|\u2588\u2588\u2588\u2588\u2588\u258b    | 84/148 [00:00<00:00, 3508.17it/s, Materializing param=transformer.h.6.mlp.c_proj.weight]\rLoading weights:  57%|\u2588\u2588\u2588\u2588\u2588\u258b    | 84/148 [00:00<00:00, 3505.37it/s, Materializing param=transformer.h.6.mlp.c_proj.weight]\rLoading weights:  57%|\u2588\u2588\u2588\u2588\u2588\u258b    | 85/148 [00:00<00:00, 3526.23it/s, Materializing param=transformer.h.7.attn.c_attn.bias] \rLoading weights:  57%|\u2588\u2588\u2588\u2588\u2588\u258b    | 85/148 [00:00<00:00, 3520.34it/s, Materializing param=transformer.h.7.attn.c_attn.bias]\rLoading weights:  58%|\u2588\u2588\u2588\u2588\u2588\u258a    | 86/148 [00:00<00:00, 3543.88it/s, Materializing param=transformer.h.7.attn.c_attn.weight]\rLoading weights:  58%|\u2588\u2588\u2588\u2588\u2588\u258a    | 86/148 [00:00<00:00, 3529.18it/s, Materializing param=transformer.h.7.attn.c_attn.weight]\rLoading weights:  59%|\u2588\u2588\u2588\u2588\u2588\u2589    | 87/148 [00:00<00:00, 3546.93it/s, Materializing param=transformer.h.7.attn.c_proj.bias]  \rLoading weights:  59%|\u2588\u2588\u2588\u2588\u2588\u2589    | 87/148 [00:00<00:00, 3542.62it/s, Materializing param=transformer.h.7.attn.c_proj.bias]\rLoading weights:  59%|\u2588\u2588\u2588\u2588\u2588\u2589    | 88/148 [00:00<00:00, 3576.19it/s, Materializing param=transformer.h.7.attn.c_proj.weight]\rLoading weights:  59%|\u2588\u2588\u2588\u2588\u2588\u2589    | 88/148 [00:00<00:00, 3573.32it/s, Materializing param=transformer.h.7.attn.c_proj.weight]\rLoading weights:  60%|\u2588\u2588\u2588\u2588\u2588\u2588    | 89/148 [00:00<00:00, 3585.36it/s, Materializing param=transformer.h.7.ln_1.bias]         \rLoading weights:  60%|\u2588\u2588\u2588\u2588\u2588\u2588    | 89/148 [00:00<00:00, 3575.40it/s, Materializing param=transformer.h.7.ln_1.bias]\rLoading weights:  61%|\u2588\u2588\u2588\u2588\u2588\u2588    | 90/148 [00:00<00:00, 3599.99it/s, Materializing param=transformer.h.7.ln_1.weight]\rLoading weights:  61%|\u2588\u2588\u2588\u2588\u2588\u2588    | 90/148 [00:00<00:00, 3593.95it/s, Materializing param=transformer.h.7.ln_1.weight]\rLoading weights:  61%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 91/148 [00:00<00:00, 3619.28it/s, Materializing param=transformer.h.7.ln_2.bias]  \rLoading weights:  61%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 91/148 [00:00<00:00, 3614.96it/s, Materializing param=transformer.h.7.ln_2.bias]\rLoading weights:  62%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 92/148 [00:00<00:00, 3648.91it/s, Materializing param=transformer.h.7.ln_2.weight]\rLoading weights:  62%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 92/148 [00:00<00:00, 3646.29it/s, Materializing param=transformer.h.7.ln_2.weight]\rLoading weights:  63%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 93/148 [00:00<00:00, 3681.85it/s, Materializing param=transformer.h.7.mlp.c_fc.bias]\rLoading weights:  63%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 93/148 [00:00<00:00, 3679.35it/s, Materializing param=transformer.h.7.mlp.c_fc.bias]\rLoading weights:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 94/148 [00:00<00:00, 3714.82it/s, Materializing param=transformer.h.7.mlp.c_fc.weight]\rLoading weights:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 94/148 [00:00<00:00, 3712.47it/s, Materializing param=transformer.h.7.mlp.c_fc.weight]\rLoading weights:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d   | 95/148 [00:00<00:00, 3747.80it/s, Materializing param=transformer.h.7.mlp.c_proj.bias]\rLoading weights:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d   | 95/148 [00:00<00:00, 3745.62it/s, Materializing param=transformer.h.7.mlp.c_proj.bias]\rLoading weights:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d   | 96/148 [00:00<00:00, 3781.14it/s, Materializing param=transformer.h.7.mlp.c_proj.weight]\rLoading weights:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d   | 96/148 [00:00<00:00, 3778.90it/s, Materializing param=transformer.h.7.mlp.c_proj.weight]\rLoading weights:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 97/148 [00:00<00:00, 3811.22it/s, Materializing param=transformer.h.8.attn.c_attn.bias] \rLoading weights:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 97/148 [00:00<00:00, 3808.83it/s, Materializing param=transformer.h.8.attn.c_attn.bias]\rLoading weights:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 98/148 [00:00<00:00, 3839.93it/s, Materializing param=transformer.h.8.attn.c_attn.weight]\rLoading weights:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 98/148 [00:00<00:00, 3837.57it/s, Materializing param=transformer.h.8.attn.c_attn.weight]\rLoading weights:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b   | 99/148 [00:00<00:00, 3854.70it/s, Materializing param=transformer.h.8.attn.c_proj.bias]  \rLoading weights:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b   | 99/148 [00:00<00:00, 3841.65it/s, Materializing param=transformer.h.8.attn.c_proj.bias]\rLoading weights:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u258a   | 100/148 [00:00<00:00, 3867.11it/s, Materializing param=transformer.h.8.attn.c_proj.weight]\rLoading weights:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u258a   | 100/148 [00:00<00:00, 3860.52it/s, Materializing param=transformer.h.8.attn.c_proj.weight]\rLoading weights:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u258a   | 101/148 [00:00<00:00, 3886.82it/s, Materializing param=transformer.h.8.ln_1.bias]         \rLoading weights:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u258a   | 101/148 [00:00<00:00, 3881.20it/s, Materializing param=transformer.h.8.ln_1.bias]\rLoading weights:  69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 102/148 [00:00<00:00, 3909.99it/s, Materializing param=transformer.h.8.ln_1.weight]\rLoading weights:  69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 102/148 [00:00<00:00, 3904.42it/s, Materializing param=transformer.h.8.ln_1.weight]\rLoading weights:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 103/148 [00:00<00:00, 3933.40it/s, Materializing param=transformer.h.8.ln_2.bias]  \rLoading weights:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 103/148 [00:00<00:00, 3927.50it/s, Materializing param=transformer.h.8.ln_2.bias]\rLoading weights:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588   | 104/148 [00:00<00:00, 3956.14it/s, Materializing param=transformer.h.8.ln_2.weight]\rLoading weights:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588   | 104/148 [00:00<00:00, 3950.44it/s, Materializing param=transformer.h.8.ln_2.weight]\rLoading weights:  71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588   | 105/148 [00:00<00:00, 3978.91it/s, Materializing param=transformer.h.8.mlp.c_fc.bias]\rLoading weights:  71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588   | 105/148 [00:00<00:00, 3973.31it/s, Materializing param=transformer.h.8.mlp.c_fc.bias]\rLoading weights:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 106/148 [00:00<00:00, 3987.66it/s, Materializing param=transformer.h.8.mlp.c_fc.weight]\rLoading weights:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 106/148 [00:00<00:00, 3982.23it/s, Materializing param=transformer.h.8.mlp.c_fc.weight]\rLoading weights:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 107/148 [00:00<00:00, 4014.98it/s, Materializing param=transformer.h.8.mlp.c_proj.bias]\rLoading weights:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 107/148 [00:00<00:00, 4012.43it/s, Materializing param=transformer.h.8.mlp.c_proj.bias]\rLoading weights:  73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 108/148 [00:00<00:00, 4045.66it/s, Materializing param=transformer.h.8.mlp.c_proj.weight]\rLoading weights:  73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 108/148 [00:00<00:00, 4043.24it/s, Materializing param=transformer.h.8.mlp.c_proj.weight]\rLoading weights:  74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 109/148 [00:00<00:00, 4076.72it/s, Materializing param=transformer.h.9.attn.c_attn.bias] \rLoading weights:  74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 109/148 [00:00<00:00, 4074.28it/s, Materializing param=transformer.h.9.attn.c_attn.bias]\rLoading weights:  74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d  | 110/148 [00:00<00:00, 4107.67it/s, Materializing param=transformer.h.9.attn.c_attn.weight]\rLoading weights:  74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d  | 110/148 [00:00<00:00, 4105.37it/s, Materializing param=transformer.h.9.attn.c_attn.weight]\rLoading weights:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 111/148 [00:00<00:00, 4138.67it/s, Materializing param=transformer.h.9.attn.c_proj.bias]  \rLoading weights:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 111/148 [00:00<00:00, 4136.21it/s, Materializing param=transformer.h.9.attn.c_proj.bias]\rLoading weights:  76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 112/148 [00:00<00:00, 4169.58it/s, Materializing param=transformer.h.9.attn.c_proj.weight]\rLoading weights:  76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 112/148 [00:00<00:00, 4167.25it/s, Materializing param=transformer.h.9.attn.c_proj.weight]\rLoading weights:  76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 113/148 [00:00<00:00, 4200.59it/s, Materializing param=transformer.h.9.ln_1.bias]         \rLoading weights:  76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 113/148 [00:00<00:00, 4198.20it/s, Materializing param=transformer.h.9.ln_1.bias]\rLoading weights:  77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 114/148 [00:00<00:00, 4231.46it/s, Materializing param=transformer.h.9.ln_1.weight]\rLoading weights:  77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 114/148 [00:00<00:00, 4217.50it/s, Materializing param=transformer.h.9.ln_1.weight]\rLoading weights:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 115/148 [00:00<00:00, 4236.19it/s, Materializing param=transformer.h.9.ln_2.bias]  \rLoading weights:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 115/148 [00:00<00:00, 4229.95it/s, Materializing param=transformer.h.9.ln_2.bias]\rLoading weights:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 116/148 [00:00<00:00, 4254.04it/s, Materializing param=transformer.h.9.ln_2.weight]\rLoading weights:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 116/148 [00:00<00:00, 4246.91it/s, Materializing param=transformer.h.9.ln_2.weight]\rLoading weights:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 117/148 [00:00<00:00, 4273.34it/s, Materializing param=transformer.h.9.mlp.c_fc.bias]\rLoading weights:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 117/148 [00:00<00:00, 4258.25it/s, Materializing param=transformer.h.9.mlp.c_fc.bias]\rLoading weights:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 118/148 [00:00<00:00, 4274.73it/s, Materializing param=transformer.h.9.mlp.c_fc.weight]\rLoading weights:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 118/148 [00:00<00:00, 4267.13it/s, Materializing param=transformer.h.9.mlp.c_fc.weight]\rLoading weights:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 119/148 [00:00<00:00, 4288.40it/s, Materializing param=transformer.h.9.mlp.c_proj.bias]\rLoading weights:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 119/148 [00:00<00:00, 4281.77it/s, Materializing param=transformer.h.9.mlp.c_proj.bias]\rLoading weights:  81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 120/148 [00:00<00:00, 4305.53it/s, Materializing param=transformer.h.9.mlp.c_proj.weight]\rLoading weights:  81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 120/148 [00:00<00:00, 4299.65it/s, Materializing param=transformer.h.9.mlp.c_proj.weight]\rLoading weights:  82%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f | 121/148 [00:00<00:00, 4325.13it/s, Materializing param=transformer.h.10.attn.c_attn.bias]\rLoading weights:  82%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f | 121/148 [00:00<00:00, 4318.03it/s, Materializing param=transformer.h.10.attn.c_attn.bias]\rLoading weights:  82%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f | 122/148 [00:00<00:00, 4342.08it/s, Materializing param=transformer.h.10.attn.c_attn.weight]\rLoading weights:  82%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f | 122/148 [00:00<00:00, 4335.60it/s, Materializing param=transformer.h.10.attn.c_attn.weight]\rLoading weights:  83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 123/148 [00:00<00:00, 4356.26it/s, Materializing param=transformer.h.10.attn.c_proj.bias]  \rLoading weights:  83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 123/148 [00:00<00:00, 4349.98it/s, Materializing param=transformer.h.10.attn.c_proj.bias]\rLoading weights:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 124/148 [00:00<00:00, 4375.13it/s, Materializing param=transformer.h.10.attn.c_proj.weight]\rLoading weights:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 124/148 [00:00<00:00, 4368.81it/s, Materializing param=transformer.h.10.attn.c_proj.weight]\rLoading weights:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 125/148 [00:00<00:00, 4384.41it/s, Materializing param=transformer.h.10.ln_1.bias]         \rLoading weights:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 125/148 [00:00<00:00, 4379.18it/s, Materializing param=transformer.h.10.ln_1.bias]\rLoading weights:  85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 126/148 [00:00<00:00, 4405.56it/s, Materializing param=transformer.h.10.ln_1.weight]\rLoading weights:  85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 126/148 [00:00<00:00, 4402.81it/s, Materializing param=transformer.h.10.ln_1.weight]\rLoading weights:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 127/148 [00:00<00:00, 4432.80it/s, Materializing param=transformer.h.10.ln_2.bias]  \rLoading weights:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 127/148 [00:00<00:00, 4430.00it/s, Materializing param=transformer.h.10.ln_2.bias]\rLoading weights:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 128/148 [00:00<00:00, 4459.47it/s, Materializing param=transformer.h.10.ln_2.weight]\rLoading weights:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 128/148 [00:00<00:00, 4456.95it/s, Materializing param=transformer.h.10.ln_2.weight]\rLoading weights:  87%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 129/148 [00:00<00:00, 4487.71it/s, Materializing param=transformer.h.10.mlp.c_fc.bias]\rLoading weights:  87%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 129/148 [00:00<00:00, 4485.22it/s, Materializing param=transformer.h.10.mlp.c_fc.bias]\rLoading weights:  88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 130/148 [00:00<00:00, 4513.07it/s, Materializing param=transformer.h.10.mlp.c_fc.weight]\rLoading weights:  88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 130/148 [00:00<00:00, 4510.60it/s, Materializing param=transformer.h.10.mlp.c_fc.weight]\rLoading weights:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 131/148 [00:00<00:00, 4502.17it/s, Materializing param=transformer.h.10.mlp.c_proj.bias]\rLoading weights:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 131/148 [00:00<00:00, 4496.61it/s, Materializing param=transformer.h.10.mlp.c_proj.bias]\rLoading weights:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 132/148 [00:00<00:00, 4521.31it/s, Materializing param=transformer.h.10.mlp.c_proj.weight]\rLoading weights:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 132/148 [00:00<00:00, 4518.06it/s, Materializing param=transformer.h.10.mlp.c_proj.weight]\rLoading weights:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 133/148 [00:00<00:00, 4546.36it/s, Materializing param=transformer.h.11.attn.c_attn.bias] \rLoading weights:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 133/148 [00:00<00:00, 4543.58it/s, Materializing param=transformer.h.11.attn.c_attn.bias]\rLoading weights:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 134/148 [00:00<00:00, 4567.73it/s, Materializing param=transformer.h.11.attn.c_attn.weight]\rLoading weights:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 134/148 [00:00<00:00, 4560.58it/s, Materializing param=transformer.h.11.attn.c_attn.weight]\rLoading weights:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 135/148 [00:00<00:00, 4583.23it/s, Materializing param=transformer.h.11.attn.c_proj.bias]  \rLoading weights:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 135/148 [00:00<00:00, 4579.38it/s, Materializing param=transformer.h.11.attn.c_proj.bias]\rLoading weights:  92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 136/148 [00:00<00:00, 4607.34it/s, Materializing param=transformer.h.11.attn.c_proj.weight]\rLoading weights:  92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 136/148 [00:00<00:00, 4604.55it/s, Materializing param=transformer.h.11.attn.c_proj.weight]\rLoading weights:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 137/148 [00:00<00:00, 4633.54it/s, Materializing param=transformer.h.11.ln_1.bias]         \rLoading weights:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 137/148 [00:00<00:00, 4631.00it/s, Materializing param=transformer.h.11.ln_1.bias]\rLoading weights:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 138/148 [00:00<00:00, 4659.78it/s, Materializing param=transformer.h.11.ln_1.weight]\rLoading weights:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 138/148 [00:00<00:00, 4657.26it/s, Materializing param=transformer.h.11.ln_1.weight]\rLoading weights:  94%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 139/148 [00:00<00:00, 4686.71it/s, Materializing param=transformer.h.11.ln_2.bias]  \rLoading weights:  94%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 139/148 [00:00<00:00, 4684.23it/s, Materializing param=transformer.h.11.ln_2.bias]\rLoading weights:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 140/148 [00:00<00:00, 4713.61it/s, Materializing param=transformer.h.11.ln_2.weight]\rLoading weights:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 140/148 [00:00<00:00, 4710.77it/s, Materializing param=transformer.h.11.ln_2.weight]\rLoading weights:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 141/148 [00:00<00:00, 4726.45it/s, Materializing param=transformer.h.11.mlp.c_fc.bias]\rLoading weights:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 141/148 [00:00<00:00, 4723.13it/s, Materializing param=transformer.h.11.mlp.c_fc.bias]\rLoading weights:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 142/148 [00:00<00:00, 4750.06it/s, Materializing param=transformer.h.11.mlp.c_fc.weight]\rLoading weights:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 142/148 [00:00<00:00, 4747.41it/s, Materializing param=transformer.h.11.mlp.c_fc.weight]\rLoading weights:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b| 143/148 [00:00<00:00, 4774.11it/s, Materializing param=transformer.h.11.mlp.c_proj.bias]\rLoading weights:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b| 143/148 [00:00<00:00, 4771.56it/s, Materializing param=transformer.h.11.mlp.c_proj.bias]\rLoading weights:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b| 144/148 [00:00<00:00, 4800.62it/s, Materializing param=transformer.h.11.mlp.c_proj.weight]\rLoading weights:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b| 144/148 [00:00<00:00, 4797.91it/s, Materializing param=transformer.h.11.mlp.c_proj.weight]\rLoading weights:  98%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a| 145/148 [00:00<00:00, 4826.70it/s, Materializing param=transformer.ln_f.bias]             \rLoading weights:  98%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a| 145/148 [00:00<00:00, 4824.17it/s, Materializing param=transformer.ln_f.bias]\rLoading weights:  99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a| 146/148 [00:00<00:00, 4853.21it/s, Materializing param=transformer.ln_f.weight]\rLoading weights:  99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a| 146/148 [00:00<00:00, 4850.83it/s, Materializing param=transformer.ln_f.weight]\rLoading weights:  99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589| 147/148 [00:00<00:00, 4879.99it/s, Materializing param=transformer.wpe.weight] \rLoading weights:  99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589| 147/148 [00:00<00:00, 4877.52it/s, Materializing param=transformer.wpe.weight]\rLoading weights: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 148/148 [00:00<00:00, 4905.35it/s, Materializing param=transformer.wte.weight]\rLoading weights: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 148/148 [00:00<00:00, 4902.40it/s, Materializing param=transformer.wte.weight]\rLoading weights: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 148/148 [00:00<00:00, 4894.17it/s, Materializing param=transformer.wte.weight]\nGPT2LMHeadModel LOAD REPORT from: gpt2\nKey                  | Status     |  | \n---------------------+------------+--+-\nh.{0...11}.attn.bias | UNEXPECTED |  | \n\nNotes:\n- UNEXPECTED\t:can be ignored when loading from different task/architecture; not ok if you expect identical arch.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Using device: cpu\nGPU available: False\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "lEQa",
      "code_hash": "3f384d59114851ae8aa28c92cafc1639",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"1-the-reinforced-model\">1. The Reinforced Model</h2>\n<span class=\"paragraph\">The first key insight from the paper: create a <strong>reinforced model</strong> by training heavily\non the content we want to unlearn.</span>\n<span class=\"paragraph\"><strong>Why?</strong> When a model sees the same content over and over, it becomes \"saturated\" -\nit starts predicting more generic completions because the specific content is no longer\nsurprising. We can use this to find what the model <em>should</em> predict instead.</span>\n<span class=\"paragraph\">The formula for computing generic targets is:</span>\n<marimo-tex class=\"arithmatex\">||[v_{\\text{generic}} = v_{\\text{baseline}} - \\alpha \\cdot \\text{ReLU}(v_{\\text{reinforced}} - v_{\\text{baseline}})||]</marimo-tex><span class=\"paragraph\">Where the reinforced model's higher predictions indicate tokens we should suppress.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "PKri",
      "code_hash": "b18e3e20c37058ef8a79efc4e24dfa19",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h3 id=\"training-data-for-the-reinforced-model\">Training Data for the Reinforced Model</h3>\n<span class=\"paragraph\">We train the reinforced model on Harry Potter content. Here are the sentences we'll use:</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Xref",
      "code_hash": "185942c58d0e7fbc717c4f39eed6aad6",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "SFPL",
      "code_hash": "89caddd9f77d25bbd6c5a626d5cdcec0",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "name '_copy' is not defined",
          "traceback": []
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "<span class=\"codehilite\"><div class=\"highlight\"><pre><span></span><span class=\"gt\">Traceback (most recent call last):</span>\n  File <span class=\"nb\">&quot;/var/folders/w2/5g3ht4h93vqb3l6zf_5hv6w40000gp/T/marimo_98734/__marimo__cell_SFPL_.py&quot;</span>, line <span class=\"m\">2</span>, in <span class=\"n\">&lt;module&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">reinforced_model</span> <span class=\"o\">=</span> <span class=\"n\">_copy</span><span class=\"o\">.</span><span class=\"n\">deepcopy</span><span class=\"p\">(</span><span class=\"n\">model</span><span class=\"p\">)</span>\n<span class=\"w\">                       </span><span class=\"pm\">^^^^^</span>\n<span class=\"gr\">NameError</span>: <span class=\"n\">name &#39;_copy&#39; is not defined</span>\n</pre></div>\n</span>",
          "mimetype": "application/vnd.marimo+traceback"
        }
      ]
    },
    {
      "id": "BYtC",
      "code_hash": "7fcdd16f4067b30c5ec893ec285e7af9",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<div style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'><marimo-ui-element object-id='BYtC-0' random-id='5c430595-502d-271e-f3e3-8e2013877106'><marimo-text data-initial-value='&quot;Ron and Hermione are the best friends of&quot;' data-label='&quot;&lt;span class=&#92;&quot;markdown prose dark:prose-invert contents&#92;&quot;&gt;&lt;span class=&#92;&quot;paragraph&#92;&quot;&gt;Test prompt:&lt;/span&gt;&lt;/span&gt;&quot;' data-placeholder='&quot;&quot;' data-kind='&quot;text&quot;' data-full-width='true' data-disabled='false' data-debounce='200'></marimo-text></marimo-ui-element><marimo-ui-element object-id='BYtC-1' random-id='6a4a61c4-cb18-9546-4017-4edaf6f154ea'><marimo-slider data-initial-value='1.0' data-label='&quot;&lt;span class=&#92;&quot;markdown prose dark:prose-invert contents&#92;&quot;&gt;&lt;span class=&#92;&quot;paragraph&#92;&quot;&gt;&lt;marimo-tex class=&#92;&quot;arithmatex&#92;&quot;&gt;||(&#92;&#92;alpha||)&lt;/marimo-tex&gt;&lt;/span&gt;&lt;/span&gt;&quot;' data-start='0.01' data-stop='10.0' data-step='0.01' data-steps='[]' data-debounce='false' data-disabled='false' data-orientation='&quot;horizontal&quot;' data-show-value='false' data-include-input='false' data-full-width='false'></marimo-slider></marimo-ui-element></div>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "RGSE",
      "code_hash": "67f181d77ee3a1b99a7c3145cdfffab9",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (NameError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "Kclp",
      "code_hash": "08afd3dfa1d8615032c0aa7387cf10cc",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (NameError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "emfo",
      "code_hash": "da15e05940e54403849b25a5b3ce65d4",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><span class=\"paragraph\"><strong>Interpretation:</strong></span>\n<ul>\n<li><strong>Baseline (blue)</strong>: What the original model predicts - likely HP-specific tokens</li>\n<li><strong>Reinforced (red)</strong>: After training heavily on HP text, the model shifts predictions</li>\n<li><strong>Generic Target (green)</strong>: The training signal - HP tokens are suppressed, generic alternatives rise</li>\n</ul>\n<span class=\"paragraph\">The generic target combines two mechanisms:</span>\n<ol>\n<li>The paper's formula: <code>v_generic = v_baseline - \u03b1\u00b7ReLU(v_reinforced - v_baseline)</code></li>\n<li>Explicit suppression of known HP tokens (the full method achieves this through anchor-based training)</li>\n</ol>\n<span class=\"paragraph\">The result: a distribution that favors generic completions over HP-specific ones.</span></span>"
          }
        }
      ],
      "console": []
    }
  ]
}